define((function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=32)}({0:function(t,e,n){"use strict";function i(t,e,n,i,r,o,s,a){var l=typeof(t=t||{}).default;"object"!==l&&"function"!==l||(t=t.default);var d,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=n,u._compiled=!0),i&&(u.functional=!0),o&&(u._scopeId=o),s?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},u._ssrRegister=d):r&&(d=a?function(){r.call(this,this.$root.$options.shadowRoot)}:r),d)if(u.functional){u._injectStyles=d;var c=u.render;u.render=function(t,e){return d.call(e),c(t,e)}}else{var p=u.beforeCreate;u.beforeCreate=p?[].concat(p,d):[d]}return{exports:t,options:u}}n.d(e,"a",(function(){return i}))},32:function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return h}));var i={data:function(){return{items:[],loading:!0,featureName:"dlp",restoreConfirmMessage:null,totalSize:0,selectedDeleteItem:null,selectedRestoreItem:null,deleteConfirmMessage:null,itemsPerPageOptions:[20,50,100],options:{page:1,itemsPerPage:20},dlpFeatureEnabled:null,dlpFeatureStatusLoaded:!1,fullDateFormat:{day:"numeric",month:"short",year:"numeric"},dateTimeFormat:{hour:"2-digit",minute:"2-digit",second:"2-digit"}}},computed:{headers:function(){return[{text:this.$t&&this.$t("items.dlp.quarantine.content"),align:"center",sortable:!1,value:"title"},{text:this.$t&&this.$t("items.dlp.quarantine.keywordDetected"),align:"center",sortable:!1,value:"keywords"},{text:this.$t&&this.$t("items.dlp.quarantine.createdDate"),align:"center",sortable:!1,value:"detectionDate"},{text:this.$t&&this.$t("items.dlp.quarantine.author"),align:"center",sortable:!1,value:"authorDisplayName"},{text:this.$t&&this.$t("items.dlp.quarantine.actions"),align:"center",sortable:!1,value:"actions"}]},externalTag:function(){return"("+this.$t("items.dlp.external.label")+")"}},watch:{options:function(){this.retrieveDlpPositiveItems()}},created:function(){var t=this,e=this.getDlpFeatureStatus(),n=this.retrieveDlpPositiveItems();Promise.all([e,n]).finally((function(){return t.$root.$applicationLoaded()}))},methods:{saveDlpFeatureStatus:function(t){!function(t){fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/dlp/changeFeatureActivation/"+t,{headers:{"Content-Type":"application/json"},credentials:"include",method:"PUT",body:JSON.stringify(t)})}(t)},deleteDlpPositiveItemConfirm:function(){var t=this;return this.loading=!0,fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/dlp/items/item/"+this.selectedDeleteItem,{method:"DELETE",credentials:"include"}).then((function(e){if(!e||!e.ok){if(e&&400===e.status)return e.text().then((function(t){throw new Error(t)}));throw new Error(t.$t("items.dlp.error.UnknownServerError"))}return t.retrieveDlpPositiveItems()})).catch((function(e){t.error=e.message||String(e),window.setTimeout((function(){t.error=null}),5e3)})).finally((function(){return t.loading=!1}))},deleteDlpPositiveItem:function(t){this.deleteConfirmMessage=this.$t("items.dlp.message.confirmDelete"),this.$refs.deleteConfirmDialog.open(),this.selectedDeleteItem=t},getDlpFeatureStatus:function(){var t=this;return this.$featureService.isFeatureEnabled(this.featureName).then((function(e){t.dlpFeatureEnabled=e,t.dlpFeatureStatusLoaded=!0}))},restoreDlpPositiveItemConfirm:function(){var t=this;return this.loading=!0,fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/dlp/items/item/restore/"+this.selectedRestoreItem,{method:"PUT",credentials:"include"}).then((function(e){if(!e||!e.ok){if(e&&400===e.status)return e.text().then((function(t){throw new Error(t)}));throw new Error(t.$t("items.dlp.error.UnknownServerError"))}return t.retrieveDlpPositiveItems()})).catch((function(e){t.error=e.message||String(e),window.setTimeout((function(){t.error=null}),5e3)})).finally((function(){return t.loading=!1}))},restoreDlpPositiveItem:function(t){this.restoreConfirmMessage=this.$t("items.dlp.message.confirmRestore"),this.$refs.restoreConfirmDialog.open(),this.selectedRestoreItem=t},retrieveDlpPositiveItems:function(){var t=this,e=this.options&&this.options.page,n=this.options&&this.options.itemsPerPage;n<=0&&(n=this.totalSize||20);var i=(e-1)*n;return this.loading=!0,function(t,e){return fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/dlp/items?offset="+(t||0)+"&limit="+e,{method:"GET",credentials:"include"}).then((function(t){if(t&&t.ok)return t.json();throw new Error("Error retrieving list of dlp positive items")}))}(i,n).then((function(e){t.items=e.entities,t.totalSize=e.size})).then((function(){t.loading=!1,t.$root.$emit("application-loaded")}))},dlpItemOwnerLink:function(t){return eXo.env.portal.context+"/"+eXo.env.portal.portalName+"/profile/"+t}}},r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{id:"dlpQuarantine"}},[n("v-card",{staticClass:"my-4 mx-2",attrs:{flat:""}},[n("v-list",[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",{staticClass:"title mb-0"},[n("v-row",{staticClass:"col-4",attrs:{"no-gutters":""}},[n("v-col",{staticClass:"col-3 pb-0 pt-5"},[n("h4",{staticClass:"font-weight-bold ma-0"},[t._v(t._s(t.$t("items.dlp.quarantine.label")))])]),t._v(" "),n("v-col",{staticClass:"col-1"},[t.dlpFeatureStatusLoaded?n("v-switch",{attrs:{dense:""},on:{change:function(e){return t.saveDlpFeatureStatus(t.dlpFeatureEnabled)}},model:{value:t.dlpFeatureEnabled,callback:function(e){t.dlpFeatureEnabled=e},expression:"dlpFeatureEnabled"}}):t._e()],1)],1)],1),t._v(" "),n("v-list-item-subtitle",{staticClass:"text-sub-title font-italic"},[t._v("\n            "+t._s(t.$t("items.dlp.quarantine.enableDisable"))+"\n          ")])],1)],1),t._v(" "),n("dlp-keywords-editor"),t._v(" "),n("v-divider",{staticClass:"mx-5"})],1),t._v(" "),n("exo-confirm-dialog",{ref:"restoreConfirmDialog",attrs:{message:t.restoreConfirmMessage,title:t.$t("items.dlp.title.confirmRestore"),"ok-label":t.$t("items.dlp.button.ok"),"cancel-label":t.$t("items.dlp.button.cancel")},on:{ok:function(e){return t.restoreDlpPositiveItemConfirm()}}}),t._v(" "),n("exo-confirm-dialog",{ref:"deleteConfirmDialog",attrs:{message:t.deleteConfirmMessage,title:t.$t("items.dlp.title.confirmDelete"),"ok-label":t.$t("items.dlp.button.ok"),"cancel-label":t.$t("items.dlp.button.cancel")},on:{ok:function(e){return t.deleteDlpPositiveItemConfirm()}}}),t._v(" "),n("v-data-table",{staticClass:"px-5 data-table-light-border",attrs:{headers:t.headers,items:t.items,loading:t.loading,options:t.options,"server-items-length":t.totalSize,"footer-props":{itemsPerPageOptions:t.itemsPerPageOptions}},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"item.detectionDate",fn:function(e){var i=e.item;return[n("div",{staticClass:"d-flex justify-center"},[n("date-format",{staticClass:"me-1",attrs:{value:i.detectionDate,format:t.fullDateFormat}}),t._v(" "),n("date-format",{staticClass:"me-1",attrs:{value:i.detectionDate,format:t.dateTimeFormat}})],1)]}},{key:"item.authorDisplayName",fn:function(e){var i=e.item;return[n("a",{staticClass:"text-decoration-underline",attrs:{href:t.dlpItemOwnerLink(i.author),target:"_blank"}},[t._v("\n          "+t._s(i.authorDisplayName)+"\n        ")]),t._v(" "),i.isExternal?n("span",{staticClass:"externalTagClass"},[t._v(t._s(t.externalTag))]):t._e()]}},{key:"item.actions",fn:function(e){var i=e.item;return[n("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:t.$t("items.dlp.quarantine.previewDownload"),expression:"$t('items.dlp.quarantine.previewDownload')",modifiers:{bottom:!0,body:!0}}],attrs:{href:i.itemUrl,target:"_blank",icon:"",text:""}},[n("i",{staticClass:"uiIconWatch"})]),t._v(" "),n("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:t.$t("items.dlp.quarantine.validate"),expression:"$t('items.dlp.quarantine.validate')",modifiers:{bottom:!0,body:!0}}],attrs:{primary:"",icon:"",text:""},on:{click:function(e){return e.preventDefault(),t.restoreDlpPositiveItem(i.id)}}},[n("i",{staticClass:"uiIconValidate"})]),t._v(" "),n("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:t.$t("items.dlp.quarantine.delete"),expression:"$t('items.dlp.quarantine.delete')",modifiers:{bottom:!0,body:!0}}],attrs:{primary:"",icon:"",text:""},on:{click:function(e){return t.deleteDlpPositiveItem(i.id)}}},[n("i",{staticClass:"uiIconTrash"})])]}}])})],1)],1)};r._withStripped=!0;var o=n(0),s=Object(o.a)(i,r,[],!1,null,null,null);s.options.__file="src/main/webapp/vue-apps/dlp-quarantine/components/DlpQuarantineApp.vue";var a=s.exports,l={data:function(){return{keywordsEdit:!1,keywords:[],modifyingKeywords:[],keywordTextLength:100,showEditBtn:!1,error:null}},watch:{modifyingKeywords:function(){this.error=null}},created:function(){this.getDlpKeywords()},methods:{getDlpKeywords:function(){var t=this;fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/dlp/items/keywords",{method:"GET",credentials:"include"}).then((function(t){if(t&&t.ok)return t.text();throw new Error("Error retrieving dlp keywords")})).then((function(e){e&&(t.keywords=e.split(","),t.modifyingKeywords=e.split(","))}))},AddKeyword:function(){var t=this,e=this.$refs.InputKeyword.value;if(""!==e){var n=this.modifyingKeywords.indexOf(e);e.trim().split(/\s+/).length>3?(this.error=this.$t("items.dlp.editKeyword.maxWordsAllowed"),window.setTimeout((function(){t.error=null}),5e3)):n>-1?(this.error=this.$t("items.dlp.editKeyword.alreadyAdded"),window.setTimeout((function(){t.error=null}),5e3)):(this.modifyingKeywords.push(this.$refs.InputKeyword.value.trim()),this.$refs.InputKeyword.value="")}},removeKeyword:function(t){var e=this.modifyingKeywords.indexOf(t);e>-1&&this.modifyingKeywords.splice(e,1)},editKeywords:function(){this.$refs.keywordsDrawer.open(),this.getDlpKeywords()},saveDlpKeywords:function(){var t;t=this.modifyingKeywords.join(),fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/dlp/items/keywords",{method:"POST",credentials:"include",body:t}).then((function(t){if(t&&t.ok)return t.json();throw new Error("Error setting dlp keywords",t)})),this.$refs.keywordsDrawer.close(),this.keywords=this.modifyingKeywords},cancel:function(){this.$refs.keywordsDrawer.close()},CleanInput:function(){this.$refs.InputKeyword.value=""}}},d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-card-text",[n("div",[n("v-chip-group",{attrs:{"active-class":"primary--text",column:""}},[n("v-row",{attrs:{"no-gutters":""}},[n("div",{staticClass:"my-auto col-1"},[n("h4",{staticClass:"font-weight-bold ma-0"},[t._v(t._s(t.$t("items.dlp.editKeyword.keywords")))])]),t._v(" "),t._l(t.keywords,(function(e){return n("v-chip",{key:e,staticClass:"my-1",attrs:{outlined:""}},[t._v("\n            "+t._s(e)+"\n          ")])})),t._v(" "),n("div",{staticClass:"my-auto"},[n("v-btn",{attrs:{icon:"",outlined:"",small:""},on:{click:t.editKeywords}},[t.keywords.length?n("i",{staticClass:"uiIconEdit uiIconLightBlue pb-2"}):n("i",{staticClass:"uiIconSocSimplePlus uiIconLightBlue"})])],1)],2)],1)],1)]),t._v(" "),n("exo-drawer",{ref:"keywordsDrawer",staticClass:"keywordsDrawer",attrs:{right:""},on:{closed:t.CleanInput}},[n("template",{slot:"title"},[t._v("\n      "+t._s(t.$t("items.dlp.editKeyword.title"))+"\n    ")]),t._v(" "),n("template",{slot:"content"},[n("v-card",{attrs:{flat:""}},[n("v-card-text",{staticClass:"pb-0"},[n("input",{ref:"InputKeyword",staticClass:"ignore-vuetify-classes inputKeyword",attrs:{placeholder:t.$t("items.dlp.editKeyword.placeholder"),maxlength:"50"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.AddKeyword(e)}}})]),t._v(" "),n("v-card-text",[n("v-chip-group",{attrs:{"active-class":"primary--text",column:""}},t._l(t.modifyingKeywords,(function(e){return n("v-chip",{key:e,staticClass:"my-1",attrs:{close:"",outlined:""},on:{"click:close":function(n){return t.removeKeyword(e)}}},[t._v("\n              "+t._s(e)+"\n            ")])})),1)],1),t._v(" "),t.error?n("v-card-text",[n("v-alert",{attrs:{type:"error"}},[t._v("\n            "+t._s(t.error)+" \n          ")])],1):t._e()],1)],1),t._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"d-flex"},[n("v-spacer"),t._v(" "),n("v-btn",{staticClass:"btn me-2",on:{click:t.cancel}},[t._v("\n          "+t._s(t.$t("items.dlp.button.cancel"))+"\n        ")]),t._v(" "),n("v-btn",{staticClass:"btn btn-primary",on:{click:t.saveDlpKeywords}},[t._v("\n          "+t._s(t.$t("items.dlp.button.save"))+"\n        ")])],1)])],2)],1)};d._withStripped=!0;var u=Object(o.a)(l,d,[],!1,null,null,null);u.options.__file="src/main/webapp/vue-apps/dlp-quarantine/components/DlpKeywordsEditor.vue";var c={"dlp-quarantine-app":a,"dlp-keywords-editor":u.exports};for(var p in c)Vue.component(p,c[p]);if(extensionRegistry){var m=extensionRegistry.loadComponents("dlp-quarantine-app");m&&m.length>0&&m.forEach((function(t){Vue.component(t.componentName,t.componentOptions)}))}document.dispatchEvent(new CustomEvent("displayTopBarLoading"));var f="undefined"!=typeof eXo?eXo.env.portal.language:"en",v=eXo.env.portal.context+"/"+eXo.env.portal.rest+"/i18n/bundle/locale.portlet.dlpQuarantine.dlpQuarantine-"+f+".json";function h(){exoi18n.loadLanguageAsync(f,v).then((function(t){var e=document.createElement("div");e.id="dlpQuarantine",Vue.createApp({mounted:function(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:'<dlp-quarantine-app v-cacheable id="dlpQuarantine" />',vuetify:Vue.prototype.vuetifyOptions,i18n:t},e,"DLP Quarantine")}))}}})}));