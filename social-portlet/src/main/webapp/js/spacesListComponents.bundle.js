define((function(){return function(e){var t={};function s(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(a,i,function(t){return e[t]}.bind(null,i));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=17)}({0:function(e,t,s){"use strict";function a(e,t,s,a,i,n,c,o){var r=typeof(e=e||{}).default;"object"!==r&&"function"!==r||(e=e.default);var l,p="function"==typeof e?e.options:e;if(t&&(p.render=t,p.staticRenderFns=s,p._compiled=!0),a&&(p.functional=!0),n&&(p._scopeId=n),c?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(c)},p._ssrRegister=l):i&&(l=o?function(){i.call(this,this.$root.$options.shadowRoot)}:i),l)if(p.functional){p._injectStyles=l;var d=p.render;p.render=function(e,t){return l.call(t),d(e,t)}}else{var u=p.beforeCreate;p.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:p}}s.d(t,"a",(function(){return a}))},17:function(e,t,s){"use strict";s.r(t);var a={props:{canCreateSpace:{type:Boolean,default:!1},filter:{type:String,default:null},appId:{type:String,default:null}},data:function(){return{keyword:null,spacesSize:0,loadingSpaces:!1,initialized:!1}},methods:{spacesLoaded:function(e){this.spacesSize=e,this.initialized||(this.$root.$applicationLoaded(),this.initialized=!0)}}},i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{staticClass:"transparent",attrs:{flat:""}},[s("exo-spaces-toolbar",{attrs:{keyword:e.keyword,filter:e.filter,"spaces-size":e.spacesSize,"can-create-space":e.canCreateSpace},on:{"keyword-changed":function(t){e.keyword=t},"filter-changed":function(t){e.filter=t}}}),e._v(" "),s("exo-spaces-card-list",{ref:"spacesList",attrs:{keyword:e.keyword,filter:e.filter,"loading-spaces":e.loadingSpaces,"spaces-size":e.spacesSize},on:{loaded:e.spacesLoaded}}),e._v(" "),s("exo-space-managers-drawer"),e._v(" "),s("exo-space-form-drawer")],1)};i._withStripped=!0;var n=s(0),c=Object(n.a)(a,i,[],!1,null,null,null);c.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpacesList.vue";var o=c.exports,r={props:{keyword:{type:String,default:null},filter:{type:String,default:null},spacesSize:{type:Number,default:0},loadingSpaces:{type:Boolean,default:!1}},data:function(){return{profileActionExtensions:[],startSearchAfterInMilliseconds:600,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,hasSpaces:!1,offset:0,pageSize:20,limit:20,spaces:[],limitToFetch:0,originalLimitToFetch:0}},computed:{canShowMore:function(){return this.loadingSpaces||this.spaces.length>=this.limitToFetch},filteredSpaces:function(){var e=this;return this.keyword&&this.loadingSpaces?this.spaces.slice().filter((function(t){return t.displayName&&t.displayName.toLowerCase().indexOf(e.keyword.toLowerCase())>=0||t.description&&t.description.toLowerCase().indexOf(e.keyword.toLowerCase())>=0})):this.spaces},selectedSpaceIndex:function(){return this.spaces.findIndex((function(e){return e.spaceUrl===eXo.env.server.portalBaseURL||0===eXo.env.server.portalBaseURL.indexOf(e.spaceUrl+"/")}))}},watch:{keyword:function(){if(!this.keyword)return this.resetSearch(),void this.searchSpaces();this.startTypingKeywordTimeout=Date.now(),this.loadingSpaces||(this.loadingSpaces=!0,this.waitForEndTyping())},spaces:function(){this.spaces.forEach((function(e){e.spaceUrl=""+eXo.env.portal.context+e.url}))},limitToFetch:function(){this.searchSpaces()},filter:function(){this.searchSpaces()}},created:function(){this.originalLimitToFetch=this.limitToFetch=this.limit,document.addEventListener("profile-extension-updated",this.refreshExtensions),this.refreshExtensions()},methods:{refreshExtensions:function(){this.profileActionExtensions=extensionRegistry.loadExtensions("profile-extension","action")||[]},searchSpaces:function(){var e=this;return this.loadingSpaces=!0,this.loadingSpaces=!0,this.$spaceService.getSpaces(this.keyword,this.offset,this.limitToFetch,this.filter).then((function(t){return e.spaces=t&&t.spaces||[],e.spacesSize=t&&t.size||0,e.hasSpaces=e.hasSpaces||e.spacesSize>0,e.$emit("loaded",e.spacesSize),e.$nextTick()})).then((function(){e.keyword&&e.filteredSpaces.length<e.originalLimitToFetch&&e.spaces.length>=e.limitToFetch&&(e.limitToFetch+=e.pageSize)})).finally((function(){return e.loadingSpaces=!1}))},resetSearch:function(){this.limitToFetch!==this.originalLimitToFetch&&(this.limitToFetch=this.originalLimitToFetch)},loadNextPage:function(){this.originalLimitToFetch=this.limitToFetch+=this.pageSize},waitForEndTyping:function(){var e=this;window.setTimeout((function(){Date.now()-e.startTypingKeywordTimeout>e.startSearchAfterInMilliseconds?e.searchSpaces():e.waitForEndTyping()}),this.endTypingKeywordTimeout)}}},l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{attrs:{flat:""}},[e.loadingSpaces?s("v-progress-linear",{attrs:{indeterminate:"",height:"2",color:"primary"}}):e._e(),e._v(" "),s("v-card-text",{staticClass:"pb-0",attrs:{id:"spacesListBody"}},[s("v-item-group",[s("v-container",{staticClass:"pa-0"},[e.filteredSpaces&&e.filteredSpaces.length?s("v-row",{staticClass:"ma-0 border-box-sizing"},e._l(e.filteredSpaces,(function(t){return s("v-col",{key:t.id,staticClass:"pa-0",attrs:{cols:"12",md:"6",lg:"4",xl:"3"}},[s("exo-space-card",{attrs:{space:t,"profile-action-extensions":e.profileActionExtensions},on:{refresh:e.searchSpaces}})],1)})),1):e.loadingSpaces?e._e():s("div",{staticClass:"d-flex text-center noSpacesYetBlock"},[s("div",{staticClass:"ma-auto noSpacesYet"},[s("p",{staticClass:"noSpacesYetIcons"},[s("v-icon",[e._v("fa-chevron-left")]),e._v(" "),s("v-icon",[e._v("fa-chevron-right")])],1),e._v(" "),e.hasSpaces?[s("p",{staticClass:"title font-weight-bold"},[e._v("\n                "+e._s(e.$t("spacesOverview.label.noResults"))+"\n              ")])]:[s("p",{staticClass:"title font-weight-bold"},[e._v("\n                "+e._s(e.$t("spacesList.label.noSpacesYet"))+"\n              ")]),e._v(" "),s("div",[e._v("\n                "+e._s(e.$t("spacesList.label.noSpacesYetDescription1"))+"\n              ")]),e._v(" "),s("span",[e._v("\n                "+e._s(e.$t("spacesList.label.noSpacesYetDescription2"))+"\n                "),s("v-btn",{staticClass:"primary--text px-0 addNewSpaceLink",attrs:{link:"",text:""},on:{click:function(t){return e.$root.$emit("addNewSpace")}}},[e._v("\n                  "+e._s(e.$t("spacesList.label.noSpacesLink"))+"\n                ")])],1)]],2)])],1)],1)],1),e._v(" "),s("v-card-actions",{staticClass:"pt-0 px-5 border-box-sizing",attrs:{id:"spacesListFooter"}},[e.canShowMore?s("v-btn",{staticClass:"loadMoreButton ma-auto btn",attrs:{loading:e.loadingSpaces,disabled:e.loadingSpaces,block:""},on:{click:e.loadNextPage}},[e._v("\n      "+e._s(e.$t("spacesList.button.showMore"))+"\n    ")]):e._e()],1)],1)};l._withStripped=!0;var p=Object(n.a)(r,l,[],!1,null,null,null);p.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpacesCardList.vue";var d=p.exports,u={props:{canCreateSpace:{type:Boolean,default:!1},keyword:{type:String,default:null},filter:{type:String,default:null},spacesSize:{type:String,default:null}},data:function(){return{filterToChange:null,bottomMenu:!1}},computed:{spaceFilters:function(){return[{text:this.$t("spacesList.filter.all"),value:"all"},{text:this.$t("spacesList.filter.userSpaces"),value:"member"}]}},watch:{keyword:function(){this.$emit("keyword-changed",this.keyword)},filter:function(){this.$emit("filter-changed",this.filter)}},methods:{openBottomMenu:function(){this.filterToChange=this.filter,this.bottomMenu=!0},changeFilterSelection:function(){this.bottomMenu=!1,this.filter=this.filterToChange}}},v=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-toolbar",{attrs:{id:"spacesListToolbar",flat:""}},[e.canCreateSpace?s("v-toolbar-title",[s("v-btn",{staticClass:"btn btn-primary pe-2 ps-0 addNewSpaceButton",on:{click:function(t){return e.$root.$emit("addNewSpace")}}},[s("v-icon",{attrs:{dark:""}},[e._v("mdi-plus")]),e._v(" "),s("span",{staticClass:"d-none d-sm-inline"},[e._v("\n        "+e._s(e.$t("spacesList.label.addNewSpace"))+"\n      ")])],1)],1):e._e(),e._v(" "),s("div",{staticClass:"text-sub-title ms-3 d-none d-sm-flex"},[e._v("\n    "+e._s(e.$t("spacesList.label.spacesSize",{0:e.spacesSize}))+"\n  ")]),e._v(" "),s("v-spacer"),e._v(" "),s("v-scale-transition",[s("v-text-field",{staticClass:"inputSpacesFilter pa-0 me-3 my-auto",attrs:{placeholder:e.$t("spacesList.label.filterSpaces"),"prepend-inner-icon":"fa-filter"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),s("v-scale-transition",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticClass:"selectSpacesFilter my-auto me-2 subtitle-1 ignore-vuetify-classes d-none d-sm-inline",on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.filter=t.target.multiple?s:s[0]}}},e._l(e.spaceFilters,(function(t){return s("option",{key:t.value,domProps:{value:t.value}},[e._v("\n        "+e._s(t.text)+"\n      ")])})),0)]),e._v(" "),s("v-icon",{staticClass:"d-sm-none",on:{click:e.openBottomMenu}},[e._v("\n    fa-filter\n  ")]),e._v(" "),s("v-bottom-sheet",{staticClass:"pa-0",model:{value:e.bottomMenu,callback:function(t){e.bottomMenu=t},expression:"bottomMenu"}},[s("v-sheet",{staticClass:"text-center",attrs:{height:"169px"}},[s("v-toolbar",{staticClass:"border-box-sizing",attrs:{color:"primary",dark:""}},[s("v-btn",{attrs:{text:""},on:{click:function(t){e.bottomMenu=!1}}},[e._v("\n          "+e._s(e.$t("spacesList.button.cancel"))+"\n        ")]),e._v(" "),s("v-spacer"),e._v(" "),s("v-toolbar-title",[s("v-icon",[e._v("fa-filter")]),e._v("\n          "+e._s(e.$t("spacesList.label.filter"))+"\n        ")],1),e._v(" "),s("v-spacer"),e._v(" "),s("v-btn",{attrs:{text:""},on:{click:e.changeFilterSelection}},[e._v("\n          "+e._s(e.$t("spacesList.button.confirm"))+"\n        ")])],1),e._v(" "),s("v-list",e._l(e.spaceFilters,(function(t){return s("v-list-item",{key:t,on:{click:function(s){e.filterToChange=t.value}}},[s("v-list-item-title",{staticClass:"align-center d-flex"},[e.filterToChange===t.value?s("v-icon",[e._v("fa-check")]):s("span",{staticClass:"me-6"}),e._v(" "),s("v-spacer"),e._v(" "),s("div",[e._v("\n              "+e._s(t.text)+"\n            ")]),e._v(" "),s("v-spacer"),e._v(" "),s("span",{staticClass:"me-6"})],1)],1)})),1)],1)],1)],1)};v._withStripped=!0;var f=Object(n.a)(u,v,[],!1,null,null,null);f.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpacesToolbar.vue";var m=f.exports,h={props:{space:{type:Object,default:function(){return{}}},profileActionExtensions:{type:Array,default:function(){return[]}}},data:function(){return{flipCard:!1}}},_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-flex",{class:e.flipCard?"spaceCardFlip spaceCardFlipped":"spaceCardFlip"},[s("div",{staticClass:"spaceCardFront"},[s("exo-space-card-front",{attrs:{space:e.space,"profile-action-extensions":e.profileActionExtensions,front:""},on:{flip:function(t){e.flipCard=!0},refresh:function(t){return e.$emit("refresh")}}})],1),e._v(" "),s("div",{staticClass:"spaceCardBack"},[s("exo-space-card-reverse",{attrs:{space:e.space},on:{flip:function(t){e.flipCard=!1}}})],1)])};_._withStripped=!0;var b=Object(n.a)(h,_,[],!1,null,null,null);b.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpaceCard.vue";var g=b.exports,S={props:{space:{type:Object,default:null},profileActionExtensions:{type:Array,default:function(){return[]}}},data:function(){return{displayActionMenu:!1,waitTimeUntilCloseMenu:200,sendingAction:!1,sendingSecondAction:!1,confirmTitle:"",confirmMessage:"",okMethod:null,displaySecondButton:!1}},computed:{spaceAvatarUrl:function(){return this.space&&(this.space.avatarUrl||"/portal/rest/v1/social/spaces/"+this.space.prettyName+"/avatar")},spaceBannerUrl:function(){return this.space&&(this.space.bannerUrl||"/portal/rest/v1/social/spaces/"+this.space.prettyName+"/banner")},spaceMenuParentId:function(){return this.space&&this.space.id&&"spaceMenuParent-"+this.space.id||"spaceMenuParent"},enabledProfileActionExtensions:function(){var e=this;return this.profileActionExtensions&&this.space&&this.space.isMember?this.profileActionExtensions.slice().filter((function(t){return t.enabled(e.space)})):[]},canUseActionsMenu:function(){return this.space&&(this.space.canEdit||this.enabledProfileActionExtensions.length)},url:function(){if(this.space&&this.space.groupId){var e=this.space.groupId.replace(/\//g,":");return eXo.env.portal.context+"/g/"+e+"/"}return"#"}},created:function(){var e=this;$(document).on("mousedown",(function(){e.displayActionMenu&&window.setTimeout((function(){e.displayActionMenu=!1,e.displaySecondButton=!1}),e.waitTimeUntilCloseMenu)}))},methods:{editSpace:function(){this.$root.$emit("editSpace",this.space)},removeSpaceConfirm:function(){this.openConfirmDialog(this.$t("spacesList.title.deleteSpace"),this.$t("spacesList.message.deleteSpace"),this.removeSpace)},removeSpace:function(){var e=this;this.sendingAction=!0,this.$spaceService.removeSpace(this.space.id).then((function(){return e.$emit("refresh")})).catch((function(e){console.error("Error processing action",e)})).finally((function(){e.sendingAction=!1}))},leaveConfirm:function(){this.space.isManager&&this.space.managersCount<=1?this.openConfirmDialog(this.$t("spacesList.warning"),this.$t("spacesList.warning.lastManager")):this.openConfirmDialog(this.$t("spacesList.title.leaveSpace"),this.$t("spacesList.message.leaveSpace",{0:"<b>"+this.space.displayName+"</b>"}),this.leave)},leave:function(){var e=this;this.sendingAction=!0,this.$spaceService.leave(this.space.id).then((function(){return e.$emit("refresh")})).catch((function(e){console.error("Error processing action",e)})).finally((function(){e.sendingAction=!1}))},acceptToJoin:function(){var e=this;this.sendingAction=!0,this.$spaceService.accept(this.space.id).then((function(){return e.$emit("refresh")})).catch((function(e){console.error("Error processing action",e)})).finally((function(){e.sendingAction=!1}))},refuseToJoin:function(){var e=this;this.sendingSecondAction=!0,this.$spaceService.deny(this.space.id).then((function(){return e.$emit("refresh")})).catch((function(e){console.error("Error processing action",e)})).finally((function(){e.sendingSecondAction=!1}))},join:function(){var e=this;this.sendingAction=!0,this.$spaceService.join(this.space.id).then((function(){return e.$emit("refresh")})).catch((function(e){console.error("Error processing action",e)})).finally((function(){e.sendingAction=!1}))},requestJoin:function(){var e=this;this.sendingAction=!0,this.$spaceService.requestJoin(this.space.id).then((function(){return e.$emit("refresh")})).catch((function(e){console.error("Error processing action",e)})).finally((function(){e.sendingAction=!1}))},cancelRequest:function(){var e=this;this.sendingAction=!0,this.$spaceService.cancel(this.space.id).then((function(){return e.$emit("refresh")})).catch((function(e){console.error("Error processing action",e)})).finally((function(){e.sendingAction=!1}))},openConfirmDialog:function(e,t,s){this.confirmTitle=e,this.confirmMessage=t,this.okMethod=s||null,this.$refs.confirmDialog.open()},okConfirmDialog:function(){this.okMethod&&this.okMethod()},closeConfirmDialog:function(){this.confirmTitle="",this.confirmMessage="",this.okMethod=null}}},x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{staticClass:"spaceCardItem d-block d-sm-flex",attrs:{id:e.spaceMenuParentId,flat:""}},[s("v-img",{staticClass:"white--text align-start d-block spaceBannerImg",attrs:{src:e.spaceBannerUrl,transition:"none",height:"80px","min-height":"80px","max-height":"80px","min-width":"100%",eager:""}}),e._v(" "),s("div",{staticClass:"spaceToolbarIcons px-2"},[s("v-btn",{staticClass:"spaceInfoIcon d-flex",attrs:{title:e.$t("spaceList.label.openSpaceInfo"),icon:"",small:""},on:{click:function(t){return e.$emit("flip")}}},[s("v-icon",{attrs:{size:"12"}},[e._v("fa-info")])],1),e._v(" "),s("v-spacer"),e._v(" "),e.canUseActionsMenu?[e.space.canEdit?s("v-btn",{staticClass:"spaceActionIcon spaceEditIcon d-none",attrs:{title:e.$t("spaceList.label.openSpaceActionMenu"),icon:"",text:""},on:{click:e.editSpace}},[s("i",{staticClass:"uiIcon uiIconEdit"})]):e._e(),e._v(" "),s("v-btn",{staticClass:"spaceMenuIcon d-block",attrs:{title:e.$t("spaceList.label.openSpaceMenu"),icon:"",text:""},on:{click:function(t){e.displayActionMenu=!0}}},[s("v-icon",{attrs:{size:"21"}},[e._v("mdi-dots-vertical")])],1),e._v(" "),s("v-menu",{ref:"actionMenu",attrs:{attach:"#"+e.spaceMenuParentId,transition:"slide-x-reverse-transition","content-class":"spaceActionMenu","offset-y":""},model:{value:e.displayActionMenu,callback:function(t){e.displayActionMenu=t},expression:"displayActionMenu"}},[s("v-list",{staticClass:"pa-0",attrs:{dense:""}},[e.space.canEdit?[s("v-list-item",{on:{click:e.editSpace}},[s("v-list-item-title",{staticClass:"subtitle-2"},[s("i",{staticClass:"uiIcon uiIconEdit"}),e._v("\n                "+e._s(e.$t("spacesList.button.edit"))+"\n              ")])],1),e._v(" "),s("v-list-item",{on:{click:e.removeSpaceConfirm}},[s("v-list-item-title",{staticClass:"subtitle-2"},[s("i",{staticClass:"uiIcon uiIconTrash"}),e._v("\n                "+e._s(e.$t("spacesList.button.remove"))+"\n              ")])],1)]:e._e(),e._v(" "),e._l(e.enabledProfileActionExtensions,(function(t,a){return s("v-list-item",{key:a,on:{click:function(s){return t.click(e.space)}}},[s("v-list-item-title",[s("i",{staticClass:"uiIcon ",class:t.icon?t.icon:"hidden"}),e._v("\n              "+e._s(t.title)+"\n            ")])],1)}))],2)],1)]:e._e()],2),e._v(" "),s("div",{staticClass:"spaceAvatar"},[s("a",{attrs:{href:e.url}},[s("v-img",{staticClass:"mx-auto",attrs:{src:e.spaceAvatarUrl,transition:"none",height:"75px",width:"75px","max-height":"75px","max-width":"75px",eager:""}})],1)]),e._v(" "),s("v-card-text",{staticClass:"spaceCardBody align-center pt-2 pb-1"},[s("a",{staticClass:"spaceDisplayName text-truncate d-block",attrs:{href:e.url,title:e.space.displayName}},[e._v("\n      "+e._s(e.space.displayName)+"\n    ")]),e._v(" "),s("v-card-subtitle",{staticClass:"spaceMembersLabel py-0"},[e._v("\n      "+e._s(e.$t("spacesList.label.members",{0:e.space.membersCount}))+"\n    ")])],1),e._v(" "),s("v-card-actions",{staticClass:"spaceCardActions"},[s("exo-confirm-dialog",{ref:"confirmDialog",attrs:{title:e.confirmTitle,message:e.confirmMessage,"ok-label":e.$t("spacesList.label.ok"),"cancel-label":e.okMethod&&e.$t("spacesList.label.cancel")},on:{ok:e.okConfirmDialog,"dialog-closed":e.closeConfirmDialog}}),e._v(" "),e.space.isMember?s("v-btn",{staticClass:"btn mx-auto spaceMembershipButton leaveSpaceButton",attrs:{loading:e.sendingAction,disabled:e.sendingAction||e.space.isUserBound,depressed:"",block:""},on:{click:e.leaveConfirm}},[s("v-icon",[e._v("mdi-minus")]),e._v(" "),s("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n        "+e._s(e.$t("spacesList.button.leave"))+"\n      ")])],1):e.space.isInvited?s("div",{staticClass:"invitationButtons"},[s("div",{staticClass:"acceptToJoinSpaceButtonParent"},[s("v-btn",{staticClass:"btn mx-auto spaceMembershipButton acceptToJoinSpaceButton",attrs:{loading:e.sendingAction,disabled:e.sendingAction,depressed:""},on:{click:e.acceptToJoin}},[s("v-icon",[e._v("mdi-check")]),e._v(" "),s("span",{staticClass:"d-flex"},[e._v("\n            "+e._s(e.$t("spacesList.button.acceptToJoin"))+"\n          ")])],1),e._v(" "),s("v-btn",{staticClass:"btn spaceButtonMenu d-inline",attrs:{depressed:"","x-small":""},on:{click:function(t){e.displaySecondButton=!e.displaySecondButton}}},[s("v-icon",[e._v("mdi-menu-down")])],1)],1),e._v(" "),s("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.displaySecondButton,expression:"displaySecondButton"}],staticClass:"btn mx-auto spaceMembershipButton refuseToJoinSpaceButton",attrs:{loading:e.sendingSecondAction,disabled:e.sendingSecondAction,depressed:"",block:""},on:{click:e.refuseToJoin}},[s("v-icon",[e._v("mdi-close")]),e._v(" "),s("span",{staticClass:"d-flex"},[e._v("\n          "+e._s(e.$t("spacesList.button.refuseToJoin"))+"\n        ")])],1)],1):e.space.isPending?s("v-btn",{staticClass:"btn mx-auto spaceMembershipButton cancelRequestToJoinSpaceButton",attrs:{loading:e.sendingAction,disabled:e.sendingAction,depressed:"",block:""},on:{click:e.cancelRequest}},[s("v-icon",[e._v("mdi-close")]),e._v(" "),s("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n        "+e._s(e.$t("spacesList.button.cancelRequest"))+"\n      ")])],1):"open"===e.space.subscription?s("v-btn",{staticClass:"btn mx-auto spaceMembershipButton joinSpaceButton",attrs:{loading:e.sendingAction,disabled:e.sendingAction,depressed:"",block:""},on:{click:e.join}},[s("v-icon",[e._v("mdi-plus")]),e._v(" "),s("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n        "+e._s(e.$t("spacesList.button.join"))+"\n      ")])],1):"validation"===e.space.subscription?s("v-btn",{staticClass:"btn mx-auto spaceMembershipButton joinSpaceButton",attrs:{loading:e.sendingAction,disabled:e.sendingAction,depressed:"",block:""},on:{click:e.requestJoin}},[s("v-icon",[e._v("mdi-plus")]),e._v(" "),s("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n        "+e._s(e.$t("spacesList.button.requestJoin"))+"\n      ")])],1):s("div",{staticClass:"joinSpaceDisabledLabel",attrs:{title:e.$t("spacesList.label.closedSpace")}},[s("v-btn",{staticClass:"btn mx-auto spaceMembershipButton joinSpaceButton",attrs:{disabled:"",depressed:"",block:""},on:{click:e.join}},[s("v-icon",[e._v("mdi-plus")]),e._v(" "),s("span",{staticClass:"spaceMembershipButtonText d-inline"},[e._v("\n          "+e._s(e.$t("spacesList.button.join"))+"\n        ")])],1)],1)],1)],1)};x._withStripped=!0;var y=Object(n.a)(S,x,[],!1,null,null,null);y.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpaceCardFront.vue";var C=y.exports,w={props:{space:{type:Object,default:null}}},L=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-card",{staticClass:"spaceCardItem d-flex flex-column",attrs:{id:e.spaceMenuParentId,flat:""}},[s("v-btn",{staticClass:"spaceInfoIcon ma-2",attrs:{absolute:"",small:"",icon:""},on:{click:function(t){return e.$emit("flip")}}},[s("v-icon",{attrs:{size:"12"}},[e._v("fa-info")])],1),e._v(" "),s("div",{staticClass:"d-flex pt-3 pb-2"},[s("p",{staticClass:"font-weight-bold ma-auto"},[e._v("\n      "+e._s(e.$t("spacesList.label.description"))+"\n    ")])]),e._v(" "),s("v-card-text",{staticClass:"align-center pa-0 flex-grow-1"},[e.space.description?[e.space.description.length>80?s("ellipsis",{directives:[{name:"show",rawName:"v-show",value:e.space.description,expression:"space.description"}],attrs:{title:e.space.description,data:e.space.description,"line-clamp":3,"end-char":"..."}}):[e._v("\n        "+e._s(e.space.description)+"\n      ")]]:e._e()],2),e._v(" "),e.space&&e.space.managers&&e.space.managers.length?[s("div",{staticClass:"d-flex px-3 pt-3"},[s("p",{staticClass:"font-weight-bold ma-auto"},[e._v("\n        "+e._s(e.$t("spacesList.title.managers"))+"\n      ")])]),e._v(" "),s("v-card-text",{staticClass:"align-center flex-grow-0"},[s("exo-user-avatars-list",{attrs:{users:e.space.managers,max:"5"},on:{"open-detail":function(t){return e.$root.$emit("displaySpaceManagers",e.space)}}})],1)]:e._e()],2)};L._withStripped=!0;var k=Object(n.a)(w,L,[],!1,null,null,null);k.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpaceCardReverse.vue";var T=k.exports,M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("exo-drawer",{ref:"managersDrawer",attrs:{right:""}},[s("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("spacesList.title.managers"))+"\n  ")]),e._v(" "),e.space&&e.space.managers?s("template",{slot:"content"},[s("v-layout",{staticClass:"ma-3",attrs:{column:""}},e._l(e.space.managers,(function(e){return s("v-flex",{key:e.id,staticClass:"flex-grow-1 text-truncate mb-1"},[s("exo-user-avatar",{attrs:{username:e.username,fullname:e.fullname,title:e.fullname,external:e.isExternal||e.external,"retrieve-extra-information":!1}})],1)})),1)],1):e._e()],2)};M._withStripped=!0;var E=Object(n.a)({data:function(){return{space:null}},mounted:function(){var e=this;this.$root.$on("displaySpaceManagers",(function(t){e.space=t,e.$refs.managersDrawer.open()}))}},M,[],!1,null,null,null);E.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpaceManagersDrawer.vue";var A=E.exports,F={data:function(){return{savingSpace:!1,spaceSaved:!1,space:{},spaceToUpdate:{},title:null,error:null,stepper:0,template:null,spaceTemplate:null,templates:[],selectedSpacesWithExternals:[],externalAlert:!1}},computed:{saveButtonDisabled:function(){return this.savingSpace||this.spaceSaved||this.stepper<3&&!this.space.id},displayedForm:function(){return this.$refs&&this.$refs["form"+this.stepper]},suggesterLabels:function(){return{placeholder:this.$t("spacesList.label.inviteMembers"),noDataLabel:this.$t("spacesList.label.noDataLabel")}},invitedSpacesWithExternals:function(){return this.$t&&this.$t("spaceList.checkExternals.warning",{0:"<strong>["+this.selectedSpacesWithExternals.join(",")+"]</strong>"})}},watch:{savingSpace:function(){this.savingSpace?this.$refs.spaceFormDrawer.startLoading():this.$refs.spaceFormDrawer.endLoading()},stepper:function(){var e=this;this.error=null,this.stepper?this.$nextTick().then((function(){var t=e.$refs["autoFocusInput"+e.stepper];t&&(t=t.focus||!t.$el?t:t.$el||t),t&&window.setTimeout((function(){t.focus()}),200)})):(this.spaceSaved=!1,this.savingSpace=!1,this.error=null)},template:function(){var e=this;this.template&&!this.space.id&&(this.spaceTemplate=this.templates.find((function(t){return t.name===e.template})),this.setSpaceTemplateProperties())},"space.invitedMembers":function(e){var t=this;this.selectedSpacesWithExternals=[],e.filter((function(e){return"space"===e.providerId})).forEach((function(e){t.$spaceService.checkExternals(e.spaceId).then((function(s){s&&"true"===s&&(t.selectedSpacesWithExternals.push(e.displayName),t.externalAlert=!0)}))}))}},created:function(){var e=this,t=window.location.search&&window.location.search.substring(1);if(t){var s=JSON.parse('{"'+decodeURI(t).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}').createSpace;s&&Boolean(s)&&this.$root.$once("application-loaded",(function(){e.$nextTick().then((function(){e.spaceToUpdate=null,e.setSpaceTemplateProperties(),e.title=e.$t("spacesList.label.addNewSpace"),e.$refs.spaceFormDrawer.open()}))}))}},mounted:function(){var e=this;this.$root.$on("addNewSpace",(function(){e.spaceToUpdate=null,e.space={subscription:"open",visibility:"private"},e.setSpaceTemplateProperties(),e.title=e.$t("spacesList.label.addNewSpace"),e.$refs.spaceFormDrawer.open()})),document.addEventListener("meeds.social.editSpace",this.editSpace),this.$root.$on("editSpace",this.editSpace),this.$spaceService.getSpaceTemplates().then((function(t){e.templates=t||[],e.spaceTemplate=e.templates.length&&e.templates[0]||null,e.template=e.spaceTemplate&&e.spaceTemplate.name}))},methods:{setSpaceTemplateProperties:function(){this.spaceTemplate&&(this.$set(this.space,"template",this.template),this.$set(this.space,"subscription",this.spaceTemplate.registration),this.$set(this.space,"visibility",this.spaceTemplate.visibility),this.$set(this.space,"invitedMembers",this.spaceTemplate.invitees&&this.spaceTemplate.invitees.split(",")||[]),this.space.invitedMembers&&this.space.invitedMembers.length&&(this.space.invitedMembers=this.space.invitedMembers.map((function(e){return{id:"organization:"+e,providerId:"organization",remoteId:e}}))))},editSpace:function(e){(e=e.detail&&e.detail.data||e)&&e.id?(this.spaceToUpdate=e,this.space=Object.assign({},e),this.template=this.space.template||this.template,this.title=this.$t("spacesList.label.editSpace",{0:this.space.displayName}),this.$refs.spaceFormDrawer.open()):console.warn("space does not have an id ",e," ignore user action")},previousStep:function(){this.stepper--},nextStep:function(e){e&&(e.preventDefault(),e.stopPropagation()),this.displayedForm&&this.displayedForm.reportValidity()&&this.stepper++},cancel:function(){this.$refs.spaceFormDrawer.close()},saveSpace:function(e){var t=this;e&&(e.preventDefault(),e.stopPropagation()),this.spaceSaved||this.savingSpace||(this.error=null,this.savingSpace=!0,this.space.id?this.$spaceService.updateSpace({id:this.space.id,displayName:this.space.displayName,description:this.space.description,visibility:this.space.visibility,subscription:this.space.subscription,invitedMembers:this.space.invitedMembers}).then((function(e){Object.assign(t.spaceToUpdate,e,{managers:t.spaceToUpdate.managers},{description:e.description||""}),t.spaceSaved=!0,window.setTimeout((function(){t.$refs.spaceFormDrawer.close()}),200)})).catch((function(e){console.warn("Error updating space ",t.space,e),String(e).indexOf("SPACE_ALREADY_EXIST")>=0?t.error=t.$t("spacesList.error.spaceWithSameNameExists"):t.error=t.$t("spacesList.error.unknownErrorWhenSavingSpace")})).finally((function(){return t.savingSpace=!1})):(this.space.template=this.template,this.$spaceService.createSpace(this.space).then((function(e){t.spaceSaved=!0,window.location.href=eXo.env.portal.context+"/g/"+e.groupId.replace(/\//g,":")})).catch((function(e){console.warn("Error creating space ",t.space,e),String(e).indexOf("SPACE_ALREADY_EXIST")>=0?t.error=t.$t("spacesList.error.spaceWithSameNameExists"):String(e).indexOf("INVALID_SPACE_NAME")>=0?t.error=t.$t("spacesList.error.InvalidSpaceName"):t.error=t.$t("spacesList.error.unknownErrorWhenSavingSpace")})).finally((function(){return t.savingSpace=!1}))))}}},B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("exo-drawer",{ref:"spaceFormDrawer",staticClass:"spaceFormDrawer",attrs:{right:""},on:{opened:function(t){e.stepper=1},closed:function(t){e.stepper=0}}},[s("template",{slot:"title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),s("template",{slot:"content"},[s("div"),e._v(" "),s("div",[s("v-stepper",{staticClass:"ma-0 py-0 me-4",attrs:{vertical:"",flat:""},model:{value:e.stepper,callback:function(t){e.stepper=t},expression:"stepper"}},[s("v-stepper-step",{staticClass:"ma-0",attrs:{complete:e.stepper>1,step:"1"}},[e._v("\n          "+e._s(e.$t("spacesList.label.spaceDetails"))+"\n        ")]),e._v(" "),s("v-stepper-content",{staticClass:"ps-4 pe-6 my-0",attrs:{step:"1"}},[s("form",{ref:"form1",on:{submit:e.nextStep}},[s("v-label",{attrs:{for:"name"}},[e._v("\n              "+e._s(e.$t("spacesList.label.name"))+"\n            ")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.space.displayName,expression:"space.displayName"}],ref:"autoFocusInput1",staticClass:"input-block-level ignore-vuetify-classes my-3",attrs:{placeholder:e.$t("spacesList.label.displayName"),type:"text",name:"name",required:""},domProps:{value:e.space.displayName},on:{input:function(t){t.target.composing||e.$set(e.space,"displayName",t.target.value)}}}),e._v(" "),s("v-label",{attrs:{for:"description"}},[e._v("\n              "+e._s(e.$t("spacesList.label.description"))+"\n            ")]),e._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.space.description,expression:"space.description"}],staticClass:"input-block-level ignore-vuetify-classes my-3",attrs:{placeholder:e.$t("spacesList.label.description"),name:"description",rows:"20",maxlength:"2000",noresize:""},domProps:{value:e.space.description},on:{input:function(t){t.target.composing||e.$set(e.space,"description",t.target.value)}}}),e._v(" "),s("v-label",{attrs:{for:"spaceTemplate"}},[e._v("\n              "+e._s(e.$t("spacesList.label.spaceTemplate"))+"\n            ")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.template,expression:"template"}],staticClass:"input-block-level ignore-vuetify-classes my-3",attrs:{disabled:e.space&&e.space.id,name:"spaceTemplate",required:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.template=t.target.multiple?s:s[0]}}},e._l(e.templates,(function(t){return s("option",{key:t.name,domProps:{value:t.name}},[e._v("\n                "+e._s(t.resolvedLabel||t.name)+"\n              ")])})),0),e._v(" "),s("div",{staticClass:"caption font-italic font-weight-light ps-1 muted"},[e._v(e._s(e.spaceTemplate&&e.spaceTemplate.resolvedDescription||""))]),e._v(" "),s("v-card-actions",{staticClass:"px-0"},[s("v-spacer"),e._v(" "),s("v-btn",{staticClass:"btn btn-primary",attrs:{outlined:""},on:{click:e.nextStep}},[e._v("\n                "+e._s(e.$t("spacesList.button.continue"))+"\n                "),s("v-icon",{staticClass:"ms-2",attrs:{size:"18"}},[e._v("\n                  "+e._s(e.$vuetify.rtl?"fa-caret-left":"fa-caret-right")+"\n                ")])],1)],1)],1)]),e._v(" "),s("v-stepper-step",{staticClass:"ma-0",attrs:{complete:e.stepper>2,step:"2"}},[e._v("\n          "+e._s(e.$t("spacesList.label.spaceAccess"))+"\n        ")]),e._v(" "),s("v-stepper-content",{staticClass:"ps-4 pe-6 my-0",attrs:{step:"2"}},[s("form",{ref:"form2",on:{submit:e.nextStep}},[s("div",{staticClass:"d-flex flex-wrap pt-2"},[s("label",{staticClass:"v-label theme--light my-auto float-left",attrs:{for:"hidden"}},[e._v("\n                "+e._s(e.$t("spacesList.label.hidden"))+"\n              ")]),e._v(" "),s("v-switch",{ref:"autoFocusInput2",staticClass:"float-left my-0 ms-4",attrs:{"true-value":"hidden","false-value":"private"},model:{value:e.space.visibility,callback:function(t){e.$set(e.space,"visibility",t)},expression:"space.visibility"}})],1),e._v(" "),s("div",{staticClass:"caption font-italic font-weight-light ps-1 muted mb-2 mt-1"},[e._v("\n              "+e._s(e.$t("spacesList.description."+(e.space.visibility||"hidden")))+"\n            ")]),e._v(" "),s("div",{staticClass:"d-flex flex-wrap pt-2"},[s("label",{staticClass:"v-label theme--light",attrs:{for:"hidden"}},[e._v("\n                "+e._s(e.$t("spacesList.label.registration"))+"\n              ")]),e._v(" "),s("v-radio-group",{staticClass:"mt-2 ms-2",attrs:{mandatory:"",row:"",inset:""},model:{value:e.space.subscription,callback:function(t){e.$set(e.space,"subscription",t)},expression:"space.subscription"}},[s("v-radio",{staticClass:"my-0",attrs:{label:e.$t("spacesList.label.open"),value:"open"}}),e._v(" "),s("v-radio",{staticClass:"my-0",attrs:{label:e.$t("spacesList.label.validation"),value:"validation"}}),e._v(" "),s("v-radio",{staticClass:"my-0",attrs:{label:e.$t("spacesList.label.closed"),value:"closed"}})],1)],1),e._v(" "),s("div",{staticClass:"caption font-italic font-weight-light ps-1 muted"},[e._v(e._s(e.$t("spacesList.description."+(e.space.subscription||"open"))))]),e._v(" "),s("v-card-actions",{staticClass:"mt-4 px-0"},[s("v-btn",{staticClass:"btn",on:{click:e.previousStep}},[s("v-icon",{staticClass:"me-2",attrs:{size:"18"}},[e._v("\n                  "+e._s(e.$vuetify.rtl?"fa-caret-right":"fa-caret-left")+"\n                ")]),e._v("\n                "+e._s(e.$t("spacesList.button.back"))+"\n              ")],1),e._v(" "),s("v-spacer"),e._v(" "),s("v-btn",{staticClass:"btn btn-primary",attrs:{outlined:""},on:{click:e.nextStep}},[e._v("\n                "+e._s(e.$t("spacesList.button.continue"))+"\n                "),s("v-icon",{staticClass:"ms-2",attrs:{size:"18"}},[e._v("\n                  "+e._s(e.$vuetify.rtl?"fa-caret-left":"fa-caret-right")+"\n                ")])],1)],1)],1)]),e._v(" "),s("v-stepper-step",{staticClass:"ma-0",attrs:{complete:e.stepper>3,step:"3"}},[e._v("\n          "+e._s(e.$t("spacesList.label.inviteUsers"))+"\n        ")]),e._v(" "),s("v-stepper-content",{staticClass:"ps-4 pe-6 my-0",attrs:{step:"3"}},[s("form",{ref:"form3",attrs:{disabled:e.savingSpace||e.spaceSaved},on:{submit:e.saveSpace}},[s("v-label",{staticClass:"mb-4",attrs:{for:"inviteMembers"}},[e._v("\n              "+e._s(e.$t("spacesList.label.users"))+"\n            ")]),e._v(" "),s("exo-identity-suggester",{ref:"autoFocusInput3",attrs:{labels:e.suggesterLabels,disabled:e.savingSpace||e.spaceSaved,"search-options":{spaceURL:e.space.prettyName},name:"inviteMembers","type-of-relations":"user_to_invite",height:"100","include-users":"","include-spaces":"",multiple:""},model:{value:e.space.invitedMembers,callback:function(t){e.$set(e.space,"invitedMembers",t)},expression:"space.invitedMembers"}}),e._v(" "),s("v-card-actions",{staticClass:"mt-4 px-0"},[s("v-btn",{staticClass:"btn",attrs:{disabled:e.savingSpace||e.spaceSaved},on:{click:e.previousStep}},[s("v-icon",{staticClass:"me-2",attrs:{size:"18"}},[e._v("\n                  "+e._s(e.$vuetify.rtl?"fa-caret-right":"fa-caret-left")+"\n                ")]),e._v("\n                "+e._s(e.$t("spacesList.button.back"))+"\n              ")],1)],1),e._v(" "),e.error?s("v-alert",{attrs:{type:"error"}},[e._v("\n              "+e._s(e.error)+"\n            ")]):e._e()],1)])],1),e._v(" "),s("div",[0!=e.selectedSpacesWithExternals.length?s("v-alert",{staticClass:"elevation-0 mb-14 me-2 pe-4",attrs:{dismissible:"",icon:"mdi-alert-circle",type:"warning"},model:{value:e.externalAlert,callback:function(t){e.externalAlert=t},expression:"externalAlert"}},[s("p",{directives:[{name:"sanitized-html",rawName:"v-sanitized-html",value:e.invitedSpacesWithExternals,expression:"invitedSpacesWithExternals"}]})]):e._e()],1)],1)]),e._v(" "),s("template",{slot:"footer"},[s("div",{staticClass:"d-flex"},[s("v-spacer"),e._v(" "),s("v-btn",{staticClass:"btn me-2",attrs:{disabled:e.savingSpace||e.spaceSaved},on:{click:e.cancel}},[[e._v("\n          "+e._s(e.$t("spacesList.button.cancel"))+"\n        ")]],2),e._v(" "),s("v-btn",{staticClass:"btn btn-primary",attrs:{loading:e.savingSpace,disabled:e.saveButtonDisabled},on:{click:e.saveSpace}},[e.spaceSaved?s("v-icon",[e._v("mdi-check-all")]):e.spaceToUpdate?[e._v("\n          "+e._s(e.$t("spacesList.button.updateSpace"))+"\n        ")]:[e._v("\n          "+e._s(e.$t("spacesList.button.createSpace"))+"\n        ")]],2)],1)])],2)};B._withStripped=!0;var I=Object(n.a)(F,B,[],!1,null,null,null);I.options.__file="src/main/webapp/vue-apps/spaces-list/components/ExoSpaceFormDrawer.vue";var N={"exo-spaces-list":o,"exo-spaces-card-list":d,"exo-spaces-toolbar":m,"exo-space-card":g,"exo-space-card-front":C,"exo-space-card-reverse":T,"exo-space-managers-drawer":A,"exo-space-form-drawer":I.exports};for(var D in N)Vue.component(D,N[D]);if(extensionRegistry){var z=extensionRegistry.loadComponents("SpacesList");z&&z.length>0&&z.forEach((function(e){Vue.component(e.componentName,e.componentOptions)}))}}})}));