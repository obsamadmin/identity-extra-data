define((function(){return function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=15)}({0:function(e,t,r){"use strict";function s(e,t,r,s,n,i,a,o){var l=typeof(e=e||{}).default;"object"!==l&&"function"!==l||(e=e.default);var u,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=r,d._compiled=!0),s&&(d.functional=!0),i&&(d._scopeId=i),a?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},d._ssrRegister=u):n&&(u=o?function(){n.call(this,this.$root.$options.shadowRoot)}:n),u)if(d.functional){d._injectStyles=u;var c=d.render;d.render=function(e,t){return u.call(t),c(e,t)}}else{var m=d.beforeCreate;d.beforeCreate=m?[].concat(m,u):[u]}return{exports:e,options:d}}r.d(t,"a",(function(){return s}))},15:function(e,t,r){"use strict";r.r(t),r.d(t,"init",(function(){return z}));var s=function(){var e=this.$createElement,t=this._self._c||e;return t("v-app",{staticClass:"white"},[t("v-card",{attrs:{flat:""}},[t("users-management-toolbar"),this._v(" "),t("users-management-list"),this._v(" "),t("users-management-user-form-drawer"),this._v(" "),t("users-management-user-membership-drawer"),this._v(" "),t("users-management-filter-drawer")],1)],1)};s._withStripped=!0;var n=r(0),i=Object(n.a)(null,s,[],!1,null,null,null);i.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagement.vue";var a=i.exports,o={data:function(){return{startSearchAfterInMilliseconds:600,endTypingKeywordTimeout:50,startTypingKeywordTimeout:0,itemsPerPageOptions:[20,50,100],users:[],user:null,currentUser:eXo.env.portal.userName,selectedUser:null,selectedUsers:[],selectedUsersUpdated:"",deleteConfirmMessage:null,keyword:null,filter:"ENABLED",selectedFiler:null,isConnected:null,userType:null,enrollmentStatus:null,lang:eXo.env.portal.language,options:{page:1,itemsPerPage:20},synchronizedDate:0,createdDate:0,totalSize:0,initialized:!1,isSuperUser:!1,loading:!0,error:null,fullDateFormat:{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}}},computed:{filteredUsers:function(){var e=this;return this.keyword&&this.loading?this.users.slice().filter((function(t){return t.userName.toLowerCase().indexOf(e.keyword.toLowerCase())>=0||t.firstName.toLowerCase().indexOf(e.keyword.toLowerCase())>=0||t.lastName.toLowerCase().indexOf(e.keyword.toLowerCase())>=0||t.email.toLowerCase().indexOf(e.keyword.toLowerCase())>=0})):this.users.slice()},headers:function(){return[{text:this.$t&&this.$t("UsersManagement.userName"),value:"userName",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.firstName"),value:"firstName",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.lastName"),value:"lastName",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.email"),value:"email",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.lastConnection"),value:"lastConnexion",align:"center",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.enrollment"),value:"enrollmentDate",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.status"),value:"enabled",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.source"),value:"isInternal",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.type"),value:"external",align:"center",width:"80px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.role"),value:"role",align:"center",width:"60px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.edit"),value:"edit",align:"center",width:"60px",class:"headerPadding",sortable:!1},{text:this.$t&&this.$t("UsersManagement.delete"),value:"delete",align:"center",width:"80px",class:"headerPadding",sortable:!1,show:this.isSuperUser}].filter((function(e){return null==e.show||!0===e.show}))}},watch:{options:function(){this.searchUsers()},filter:function(){this.options.page=1,this.searchUsers()},selectedUsers:function(e){document.dispatchEvent(new CustomEvent("multiSelect",{detail:{usersSelected:e.length>0}}))},keyword:function(){this.options.page=1,this.keyword?(this.startTypingKeywordTimeout=Date.now(),this.loading||(this.loading=!0,this.waitForEndTyping())):this.searchUsers()}},created:function(){var e=this;this.$userService.isSuperUser().then((function(t){e.isSuperUser="true"===t.isSuperUser})),this.$root.$on("searchUser",this.updateSearchTerms),this.$root.$on("refreshUsers",this.searchUsers),this.$root.$on("multiSelectAction",this.multiSelectAction),this.$root.$on("applyAdvancedFilter",this.applyAdvancedFilter)},methods:{updateSearchTerms:function(e,t){this.keyword=e,this.filter=t},multiSelectAction:function(e){var t=this,r=[],s="";if(this.selectedUsers.length>0){for(var n=0;n<this.selectedUsers.length;n++)r.push(this.selectedUsers[n].userName);this.selectedUsers=[],this.loading=!0,this.$userService.multiSelectAction(e,r).then((function(r){r.length>0&&(s=t.$t("UsersManagement.selection.success."+e))})).finally((function(){t.initialized||t.$root.$applicationLoaded(),t.searchUsers(),t.loading=!1,t.initialized=!0,t.selectedUsersUpdated=s,setTimeout((function(){return t.selectedUsersUpdated=""}),3e3)}))}},synchronizedTitle:function(e){return e?this.$t("UsersManagement.source.synchronized",{0:this.formatDate(e)}):this.$t("UsersManagement.source.synchronized.notProvided")},createdTitle:function(e){return this.$t("UsersManagement.source.createdUser",{0:this.formatDate(e)})},deleteUser:function(e){this.currentUser!==e.userName?(this.selectedUser=e,this.deleteConfirmMessage=this.$t("UsersManagement.message.confirmDelete",{0:this.selectedUser.fullName}),this.$refs.deleteConfirmDialog.open()):this.$refs.currentUserWarningDialog.open()},deleteUserConfirm:function(){var e=this;this.loading=!0;var t=this,r=this.selectedUser.userName;return fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/users/"+r,{method:"DELETE",credentials:"include"}).then((function(s){if(!s||!s.ok){if(s&&400===s.status)return s.text().then((function(e){throw new Error(e)}));throw new Error(e.$t("IDMManagement.error.UnknownServerError"))}t.users=t.users.filter((function(e){return e.userName!==r}))})).catch((function(t){var r="UsersManagement.error."+(t=t.message||String(t)),s=e.$t(r,{0:e.selectedUser.fullname});s!==r&&(t=s),e.error=t,window.setTimeout((function(){e.error=null}),5e3)})).finally((function(){return e.loading=!1}))},searchUsers:function(){var e=this,t=this.options&&this.options.page,r=this.options&&this.options.itemsPerPage;r<=0&&(r=this.totalSize||20);var s=(t-1)*r;this.loading=!0;var n="ENABLED"===this.filter?"false":"true";return null==this.selectedFiler||"internal"!==this.selectedFiler&&"external"!==this.selectedFiler||(this.userType=this.selectedFiler),null==this.selectedFiler||"connected"!==this.selectedFiler&&"neverConnected"!==this.selectedFiler||(this.isConnected=this.selectedFiler),null==this.selectedFiler||"enrolled"!==this.selectedFiler&&"notEnrolled"!==this.selectedFiler&&"noEnrollmentPossible"!==this.selectedFiler||(this.enrollmentStatus=this.selectedFiler),fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/social/users?q="+(this.keyword||"")+"&isDisabled="+n+"&status="+(this.filter||"ENABLED")+"&userType="+(this.userType||"")+(null!=this.isConnected?"&isConnected="+this.isConnected:"")+(null!=this.enrollmentStatus?"&enrollmentStatus="+this.enrollmentStatus:"")+"&offset="+(s||0)+"&limit="+r+"&returnSize=true",{method:"GET",credentials:"include"}).then((function(t){if(t&&t.ok)return t.json();throw new Error(e.$t("IDMManagement.error.UnknownServerError"))})).then((function(t){var r=t.entities||t.users;return r.forEach((function(t){t.enabled=t.enabled||!1,t.userName=t.userName||t.username||"",t.firstName=t.firstName||t.firstname||"",t.lastName=t.lastName||t.lastname||"",t.email=t.email||"",t.synchronizedDate&&(t.synchronizedDate=Number(t.synchronizedDate)),t.createdDate&&(t.createdDate=Number(t.createdDate)),t.lastLoginTime?(t.lastLoginTime=Number(t.lastLoginTime),null!=t.enrollmentDate?(t.enrollmentStatus="invitationAccepted",t.enrollmentDetails=e.$t("UsersManagement.enrollment.invitationAccepted",{0:e.formatDate(Number(t.enrollmentDate))})):(t.enrollmentStatus="alreadyConnected",t.enrollmentDetails=e.$t("UsersManagement.enrollment.alreadyConnected"))):(t.connectionStatus=e.$t("UsersManagement.lastConnection.neverConnected"),"true"===t.external?(t.enrollmentStatus="cannotBeEnrolled",t.enrollmentDetails=e.$t("UsersManagement.enrollment.cannotBeEnrolled")):null!=t.enrollmentDate?(t.enrollmentStatus="reInviteToJoin",t.enrollmentDetails=e.$t("UsersManagement.enrollment.reInviteToJoin",{0:e.formatDate(Number(t.enrollmentDate))})):(t.enrollmentStatus="inviteToJoin",t.enrollmentDetails=e.$t("UsersManagement.enrollment.inviteToJoin")))})),e.users=r,e.totalSize=t&&t.size||0,e.$nextTick()})).finally((function(){e.initialized||e.$root.$applicationLoaded(),e.loading=!1,e.initialized=!0,e.isConnected=null,e.userType=null,e.enrollmentStatus=null}))},waitForEndTyping:function(){var e=this;window.setTimeout((function(){Date.now()-e.startTypingKeywordTimeout>e.startSearchAfterInMilliseconds?e.searchUsers():e.waitForEndTyping()}),this.endTypingKeywordTimeout)},saveUserStatus:function(e){var t=this;return this.error=null,this.user={userName:e.userName,firstName:e.firstName,lastName:e.lastName,email:e.email,enabled:!e.enabled},fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/users",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.user)}).then((function(r){if(!r||!r.ok){if(400===r.status)return r.text().then((function(r){var s="UsersManagement.error."+(r=r.message||String(r)),n=t.$t(s,{0:e.fullname});n!==s&&(r=n),t.error=r,window.setTimeout((function(){t.error=null}),5e3)}));throw new Error(t.$t("IDMManagement.error.UnknownServerError"))}})).finally((function(){t.initialized||t.$root.$applicationLoaded(),t.searchUsers(),t.loading=!1,t.initialized=!0}))},formatDate:function(e){return this.$dateUtil.formatDateObjectToDisplay(new Date(e),this.fullDateFormat,this.lang)},sendOnBoardingEmail:function(e){var t=this;return this.loading=!0,fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/social/users/onboard/"+e,{method:"PATCH",credentials:"include"}).then((function(e){if(e&&e.ok)return e.json();throw new Error("Error sending onBoarding email")})).finally((function(){t.initialized||t.$root.$applicationLoaded(),t.searchUsers(),t.loading=!1,t.initialized=!0}))},applyAdvancedFilter:function(e){this.selectedFiler=e,this.searchUsers()}}},l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("users-management-import-csv-result",{staticClass:"px-4"}),e._v(" "),r("exo-confirm-dialog",{ref:"deleteConfirmDialog",attrs:{message:e.deleteConfirmMessage,title:e.$t("UsersManagement.title.confirmDelete"),"ok-label":e.$t("UsersManagement.button.ok"),"cancel-label":e.$t("UsersManagement.button.cancel")},on:{ok:function(t){return e.deleteUserConfirm()}}}),e._v(" "),r("exo-confirm-dialog",{ref:"currentUserWarningDialog",attrs:{message:e.$t("UsersManagement.message.deleteCurrentUserWarning"),title:e.$t("UsersManagement.title.deleteCurrentUserWarning"),"ok-label":e.$t("UsersManagement.button.ok")}}),e._v(" "),e.error?r("v-card-text",{staticClass:"errorMessage"},[r("v-alert",{attrs:{type:"error"}},[e._v("\n      "+e._s(e.error)+"\n    ")])],1):e._e(),e._v(" "),r("v-data-table",{staticClass:"data-table-light-border",attrs:{headers:e.headers,items:e.filteredUsers,loading:e.loading,options:e.options,"server-items-length":e.totalSize,"footer-props":{itemsPerPageOptions:e.itemsPerPageOptions},"loading-text":e.$t("UsersManagement.loadingResults"),"no-results-text":e.$t("UsersManagement.noResultsFound"),"no-data-text":e.$t("UsersManagement.noData"),"show-select":""},on:{"update:options":function(t){e.options=t}},scopedSlots:e._u([{key:"item.lastConnexion",fn:function(t){var s=t.item;return[s.lastLoginTime?r("div",[r("date-format",{staticClass:"grey--text me-1",attrs:{value:s.lastLoginTime,format:e.fullDateFormat}})],1):r("div",{staticClass:"grey--text"},[e._v("\n        "+e._s(s.connectionStatus)+"\n      ")])]}},{key:"item.enrollmentDate",fn:function(t){var s=t.item;return["invitationAccepted"===s.enrollmentStatus?r("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline"},[r("v-badge",{staticClass:"mailBadge",attrs:{bottom:"",color:"white",flat:"","offset-x":"8","offset-y":"12"}},[r("span",{attrs:{slot:"badge"},slot:"badge"},[r("v-icon",{staticClass:"successColor mt-n1 me-0",attrs:{size:"14"}},[e._v("mdi-check-circle")])],1),e._v(" "),r("v-icon",{attrs:{size:"22",color:"primary"}},[e._v("mdi-email")])],1)],1):"reInviteToJoin"===s.enrollmentStatus?r("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline"},[r("v-badge",{staticClass:"mailBadge",attrs:{bottom:"",color:"white",flat:"","offset-x":"15","offset-y":"19"}},[r("span",{attrs:{slot:"badge"},slot:"badge"},[r("v-icon",{staticClass:"errorColor mt-n1 me-0",attrs:{size:"14"}},[e._v("mdi-help-circle")])],1),e._v(" "),r("v-btn",{attrs:{icon:""},on:{click:function(t){return e.sendOnBoardingEmail(s.username)}}},[r("v-icon",{attrs:{size:"22",color:"primary"}},[e._v("mdi-email")])],1)],1)],1):"inviteToJoin"===s.enrollmentStatus?r("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline"},[r("v-btn",{attrs:{icon:""},on:{click:function(t){return e.sendOnBoardingEmail(s.username)}}},[r("v-icon",{attrs:{size:"22",color:"primary"}},[e._v("mdi-email")])],1)],1):r("div",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.enrollmentDetails,expression:"item.enrollmentDetails",modifiers:{bottom:!0,body:!0}}],staticClass:"d-inline mailBadge"},[r("v-icon",{staticClass:"disabled",attrs:{size:"22"}},[e._v("mdi-email")])],1)]}},{key:"item.enabled",fn:function(t){var s=t.item;return[r("div",[r("label",{staticClass:"switch"},[r("input",{directives:[{name:"model",rawName:"v-model",value:s.enabled,expression:"item.enabled"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(s.enabled)?e._i(s.enabled,null)>-1:s.enabled},on:{click:function(t){return e.saveUserStatus(s)},change:function(t){var r=s.enabled,n=t.target,i=!!n.checked;if(Array.isArray(r)){var a=e._i(r,null);n.checked?a<0&&e.$set(s,"enabled",r.concat([null])):a>-1&&e.$set(s,"enabled",r.slice(0,a).concat(r.slice(a+1)))}else e.$set(s,"enabled",i)}}}),e._v(" "),r("div",{staticClass:"slider round"},[r("span",{staticClass:"absolute-activate"},[e._v(e._s(e.$t("UsersManagement.button.enabled")))])]),e._v(" "),r("span",{staticClass:"absolute-deactivated"},[e._v(e._s(e.$t("UsersManagement.button.disabled")))])])])]}},{key:"item.isInternal",fn:function(t){var s=t.item;return[s.isInternal?r("div",{staticClass:"displayedIconClass"},[r("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:e.createdTitle(s.createdDate),expression:"createdTitle(item.createdDate)",modifiers:{bottom:!0,body:!0}}],attrs:{primary:"",icon:"",text:""}},[r("i",{staticClass:"uiIconSoupCan"},[r("span",{staticClass:"internalIconClass"},[e._v("eXo")])])])],1):r("div",{staticClass:"displayedIconClass"},[r("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:e.synchronizedTitle(s.synchronizedDate),expression:"synchronizedTitle(item.synchronizedDate)",modifiers:{bottom:!0,body:!0}}],attrs:{primary:"",icon:"",text:""}},[r("i",{staticClass:"uiIconManageApplication"},[r("span",{staticClass:"synchronizedIconClass"},[e._v("SYNC")])])])],1)]}},{key:"item.external",fn:function(t){var r=t.item;return[e._v("\n      "+e._s(r&&"true"===r.external?e.$t("UsersManagement.type.external"):e.$t("UsersManagement.type.internal"))+"\n    ")]}},{key:"item.role",fn:function(t){var s=t.item;return[r("v-btn",{attrs:{title:e.$t("UsersManagement.button.membership"),primary:"",icon:"",text:""},on:{click:function(t){return e.$root.$emit("openUserMemberships",s)}}},[r("i",{staticClass:"uiIconGroup"})])]}},{key:"item.edit",fn:function(t){var s=t.item;return[r("span",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:s.isInternal?e.$t("UsersManagement.button.editUser"):e.$t("UsersManagement.tooltip.editSynchronzedUser"),expression:"item.isInternal ? $t('UsersManagement.button.editUser') : $t('UsersManagement.tooltip.editSynchronzedUser')",modifiers:{bottom:!0,body:!0}}]},[r("v-btn",{attrs:{disabled:!s.isInternal,icon:"",text:""},on:{click:function(t){return e.$root.$emit("editUser",s)}}},[r("i",{staticClass:"uiIconEdit",class:s.isInternal?"uiIconEdit":"uiDiseabledIconEdit"})])],1)]}},{key:"item.delete",fn:function(t){var s=t.item;return[r("v-btn",{attrs:{title:e.$t("UsersManagement.button.deleteUser"),primary:"",icon:"",text:""},on:{click:function(t){return e.deleteUser(s)}}},[r("i",{staticClass:"uiIconTrash trashIconColor"})])]}}]),model:{value:e.selectedUsers,callback:function(t){e.selectedUsers=t},expression:"selectedUsers"}}),e._v(" "),e.selectedUsersUpdated?r("v-alert",{staticClass:"userUpdated",attrs:{border:"left",type:"info","close-icon":"mdi-close","colored-border":"",color:"primary",dismissible:""}},[e._v("\n    "+e._s(e.selectedUsersUpdated)+"\n  ")]):e._e()],1)};l._withStripped=!0;var u=Object(n.a)(o,l,[],!1,null,null,null);u.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementList.vue";var d=u.exports,c={data:function(){return{filter:"ENABLED",initialized:!1,keyword:null,usersSelected:!1,numberOfFilters:0,selectedFiler:null,isDelegatedAdministrator:!0}},watch:{keyword:function(){this.$root.$emit("searchUser",this.keyword,this.filter)},filter:function(){this.$root.$emit("searchUser",this.keyword,this.filter)}},created:function(){var e=this;this.$userService.isDelegatedAdministrator().then((function(t){e.isDelegatedAdministrator="true"===t.result})),document.addEventListener("multiSelect",this.updateSelectedUsers),this.$root.$on("applyAdvancedFilter",this.applyAdvancedFilter)},updated:function(){var e=this;window.setTimeout((function(){return e.initialized=!0}),1e3)},methods:{updateSelectedUsers:function(e){this.usersSelected=e.detail.usersSelected},multiSelectAction:function(e){this.$root.$emit("multiSelectAction",e)},applyAdvancedFilter:function(e){this.selectedFiler=e,this.numberOfFilters=this.countFiltersMethods(e)},countFiltersMethods:function(e){var t=0;return null!=e&&t++,t}}},m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-toolbar",{attrs:{id:"usersManagementToolbar",flat:""}},[r("v-toolbar-title",{staticClass:"nav-collapse overflow-visible"},[e.isDelegatedAdministrator?e._e():r("div",{staticClass:"btn-group"},[r("v-btn",{staticClass:"btn btn-primary addNewUserButton",on:{click:function(t){return e.$root.$emit("addNewUser")}}},[r("i",{staticClass:"uiIconAddUser uiIconWhite me-md-3"}),e._v(" "),r("span",{staticClass:"d-none d-sm-inline"},[e._v("\n          "+e._s(e.$t("UsersManagement.addUser"))+"\n        ")])]),e._v(" "),r("v-btn",{staticClass:"btn btn-primary dropdown-toggle width-auto pa-0",attrs:{"data-toggle":"dropdown"}},[r("span",{staticClass:"caret my-0 mx-3"})]),e._v(" "),e.initialized?r("div",{staticClass:"dropdown-menu"},[r("users-management-import-csv-button")],1):e._e()],1),e._v(" "),r("v-btn",{staticClass:"mx-1 multiSelect",attrs:{disabled:!e.usersSelected,outlined:"",color:"primary"},on:{click:function(t){return e.multiSelectAction("onboard")}}},[r("i",{staticClass:"uiIconInviteUser me-2 mb-2"}),e._v("\n      "+e._s(e.$t("UsersManagement.selection.onboard"))+"\n    ")]),e._v(" "),r("v-btn",{staticClass:"multiSelect",attrs:{disabled:!e.usersSelected,outlined:"",color:"primary"},on:{click:function(t){return e.multiSelectAction("enable")}}},[r("i",{staticClass:"uiIconValidateUser me-2 mb-2"}),e._v("\n      "+e._s(e.$t("UsersManagement.selection.enable"))+"\n    ")]),e._v(" "),r("v-btn",{staticClass:"multiSelect",attrs:{disabled:!e.usersSelected,outlined:"",color:"primary"},on:{click:function(t){return e.multiSelectAction("disable")}}},[r("i",{staticClass:"uiIconRejectUser me-2 mb-2"}),e._v("\n      "+e._s(e.$t("UsersManagement.selection.disable"))+"\n    ")])],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-scale-transition",[r("v-text-field",{staticClass:"inputUserFilter pa-0 me-3 my-auto",attrs:{placeholder:e.$t("UsersManagement.filterBy"),"prepend-inner-icon":"fa-filter"},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),r("v-scale-transition",[r("select",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticClass:"selectUsersFilter width-auto my-auto me-2 pe-2 subtitle-1 ignore-vuetify-classes d-none d-sm-inline",on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.filter=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"ENABLED"}},[e._v("\n        "+e._s(e.$t("UsersManagement.status.enabled"))+"\n      ")]),e._v(" "),r("option",{attrs:{value:"DISABLED"}},[e._v("\n        "+e._s(e.$t("UsersManagement.status.disabled"))+"\n      ")])])]),e._v(" "),"ENABLED"!==e.filter||e.isDelegatedAdministrator?e._e():r("v-btn",{attrs:{"min-width":"auto",outlined:""},on:{click:function(t){return e.$root.$emit("advancedFilter",e.selectedFiler)}}},[r("i",{staticClass:"uiSettingsIcon"}),e._v(" "),e.numberOfFilters>0?r("div",{staticClass:"pb-1"},[e._v("\n      ("+e._s(e.numberOfFilters)+")\n    ")]):e._e()])],1)};m._withStripped=!0;var p=Object(n.a)(c,m,[],!1,null,null,null);p.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementToolbar.vue";var f=p.exports,h={data:function(){return{error:null,fieldError:!1,drawer:!1,newUser:!1,saving:!1,confirmNewPassword:null,user:{enabled:!0}}},computed:{title:function(){return this.newUser?this.$t("UsersManagement.addUser"):this.$t("UsersManagement.editUser")}},watch:{confirmNewPassword:function(){this.resetCustomValidity()},saving:function(){this.saving?this.$refs.userFormDrawer.startLoading():this.$refs.userFormDrawer.endLoading()},drawer:function(){var e=this;this.drawer?(this.$refs.userFormDrawer.open(),window.setTimeout((function(){e.newUser?e.$refs.userNameInput.focus():e.$refs.firstNameInput.focus()}),200)):this.$refs.userFormDrawer.close()}},created:function(){this.$root.$on("addNewUser",this.addNewUser),this.$root.$on("editUser",this.editUser)},methods:{resetCustomValidity:function(){this.$refs.userNameInput.setCustomValidity(""),this.$refs.firstNameInput.setCustomValidity(""),this.$refs.lastNameInput.setCustomValidity(""),this.$refs.emailInput.setCustomValidity(""),this.$refs.newPasswordInput.setCustomValidity(""),this.$refs.confirmNewPassword.setCustomValidity("")},addNewUser:function(){this.user={enabled:!0},this.newUser=!0,this.drawer=!0},editUser:function(e){this.user=Object.assign({},e),this.newUser=!1,this.drawer=!0},saveUser:function(e){var t=this;if(e&&(e.preventDefault(),e.stopPropagation()),this.error=null,this.fieldError=!1,this.resetCustomValidity(),this.$refs.userForm.validate()&&this.$refs.userForm.$el.reportValidity()&&(!this.confirmNewPassword||!this.user.password||this.confirmNewPassword===this.user.password||(this.$refs.confirmNewPassword.setCustomValidity(this.$t("UsersManagement.newPasswordsDoesNotMatch")),this.$refs.userForm.$el.reportValidity())))return this.saving=!0,fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/users",{method:this.newUser?"POST":"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.user)}).then((function(e){if(!e||!e.ok){if(400===e.status)return e.text().then((function(e){throw t.fieldError=e,new Error(e)}));throw new Error(t.$t("IDMManagement.error.UnknownServerError"))}})).then((function(){return t.$root.$emit("refreshUsers")})).then((function(){return t.$refs.userFormDrawer.close()})).catch(this.handleError).finally((function(){return t.saving=!1}))},cancel:function(){this.drawer=!1},handleError:function(e){var t=this;if(this.resetCustomValidity(),e){if(this.fieldError&&0===this.fieldError.indexOf("USERNAME:"))if("USERNAME:ALREADY_EXISTS"===this.fieldError)this.$refs.userNameInput.setCustomValidity(this.$t("UsersManagement.message.userWithSameNameAlreadyExists"));else{var r=this.fieldError.replace("USERNAME:","");this.$refs.userNameInput.setCustomValidity(r)}else if(this.fieldError&&0===this.fieldError.indexOf("FIRSTNAME:")){var s=this.fieldError.replace("FIRSTNAME:","");this.$refs.firstNameInput.setCustomValidity(s)}else if(this.fieldError&&0===this.fieldError.indexOf("LASTNAME:")){var n=this.fieldError.replace("LASTNAME:","");this.$refs.lastNameInput.setCustomValidity(n)}else if(this.fieldError&&0===this.fieldError.indexOf("EMAIL:"))if("EMAIL:ALREADY_EXISTS"===this.fieldError)this.$refs.emailInput.setCustomValidity(this.$t("UsersManagement.message.userWithSameEmailAlreadyExists"));else{var i=this.fieldError.replace("EMAIL:","");this.$refs.emailInput.setCustomValidity(i)}else if(this.fieldError&&0===this.fieldError.indexOf("PASSWORD:")){var a=this.fieldError.replace("PASSWORD:","");this.$refs.newPasswordInput.setCustomValidity(a)}else{var o="UsersManagement.error."+(e=e.message||String(e)),l=this.$t(o,{0:this.user.fullname});l!==o&&(e=l),this.error=e,window.setTimeout((function(){t.error=null}),5e3)}window.setTimeout((function(){t.$refs.userForm.validate()&&t.$refs.userForm.$el.reportValidity()}),200)}else this.error=null}}},v=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("exo-drawer",{ref:"userFormDrawer",attrs:{id:"userFormDrawer",right:""},on:{closed:function(t){e.drawer=!1}}},[r("template",{slot:"title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),r("template",{slot:"content"},[r("v-form",{ref:"userForm",staticClass:"form-horizontal pt-0 pb-4",attrs:{flat:""},on:{submit:e.saveUser}},[e.error?r("v-card-text",{staticClass:"errorMessage"},[r("v-alert",{attrs:{type:"error"}},[e._v("\n          "+e._s(e.error)+"\n        ")])],1):e._e(),e._v(" "),r("v-card-text",{staticClass:"d-flex userNameLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.userName"))),e.newUser?[e._v("*")]:e._e()],2),e._v(" "),r("v-card-text",{staticClass:"d-flex userNameField py-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.userName,expression:"user.userName"}],ref:"userNameInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving||!e.newUser,autofocus:e.drawer,type:"text",maxlength:"2000",required:""},domProps:{value:e.user.userName},on:{input:function(t){t.target.composing||e.$set(e.user,"userName",t.target.value)}}})]),e._v(" "),r("v-card-text",{staticClass:"d-flex firstNameLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.firstName"))+"*\n      ")]),e._v(" "),r("v-card-text",{staticClass:"d-flex firstNameField py-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.firstName,expression:"user.firstName"}],ref:"firstNameInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving,type:"text",maxlength:"2000",required:""},domProps:{value:e.user.firstName},on:{input:function(t){t.target.composing||e.$set(e.user,"firstName",t.target.value)}}})]),e._v(" "),r("v-card-text",{staticClass:"d-flex lastNameLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.lastName"))+"*\n      ")]),e._v(" "),r("v-card-text",{staticClass:"d-flex lastNameField py-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.lastName,expression:"user.lastName"}],ref:"lastNameInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving,type:"text",maxlength:"2000",required:""},domProps:{value:e.user.lastName},on:{input:function(t){t.target.composing||e.$set(e.user,"lastName",t.target.value)}}})]),e._v(" "),r("v-card-text",{staticClass:"d-flex emailLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.email"))+"*\n      ")]),e._v(" "),r("v-card-text",{staticClass:"d-flex emailField py-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],ref:"emailInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving,type:"email",maxlength:"2000",required:""},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}})]),e._v(" "),r("v-card-text",{staticClass:"d-flex newPasswordLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.password"))),e.newUser?[e._v("*")]:e._e()],2),e._v(" "),r("v-card-text",{staticClass:"d-flex newPasswordField py-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],ref:"newPasswordInput",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving||!e.user.isInternal&&!e.newUser,required:e.newUser,type:"password",autocomplete:"new-password"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}})]),e._v(" "),r("v-card-text",{staticClass:"d-flex confirmPasswordLabel flex-grow-1 text-no-wrap text-left font-weight-bold pb-2"},[e._v("\n        "+e._s(e.$t("UsersManagement.confirmPassword"))),e.newUser?[e._v("*")]:e._e()],2),e._v(" "),r("v-card-text",{staticClass:"d-flex confirmPasswordField py-0"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmNewPassword,expression:"confirmNewPassword"}],ref:"confirmNewPassword",staticClass:"ignore-vuetify-classes flex-grow-1",attrs:{disabled:e.saving||!e.user.isInternal&&!e.newUser,required:e.newUser,type:"password",autocomplete:"new-password"},domProps:{value:e.confirmNewPassword},on:{input:function(t){t.target.composing||(e.confirmNewPassword=t.target.value)}}})])],1)],1),e._v(" "),r("template",{slot:"footer"},[r("div",{staticClass:"d-flex"},[r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"btn me-2",attrs:{disabled:e.saving},on:{click:e.cancel}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.cancel"))+"\n      ")]),e._v(" "),r("v-btn",{staticClass:"btn btn-primary",attrs:{disabled:e.saving,loading:e.saving},on:{click:e.saveUser}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.save"))+"\n      ")])],1)])],2)};v._withStripped=!0;var g=Object(n.a)(h,v,[],!1,null,null,null);g.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementUserFormDrawer.vue";var _=g.exports,w={data:function(){return{drawer:!1,loading:!1,saving:!1,pageSize:10,page:1,offset:0,limit:5,memberships:{},user:{}}},computed:{title:function(){return this.$t("UsersManagement.button.membershipsOfUser",{0:this.user.fullname})},userName:function(){return this.user&&this.user.userName},membershipsArray:function(){return this.memberships&&this.memberships.entities||[]},hasPagination:function(){return this.memberships.size>this.pageSize},pagesCount:function(){return parseInt((this.memberships.size+this.pageSize-1)/this.pageSize)},headers:function(){return[{text:this.$t&&this.$t("UsersManagement.membershipType"),value:"membershipType",align:"center",sortable:!1},{text:this.$t&&this.$t("UsersManagement.group"),value:"groupId",align:"left",sortable:!1}]}},watch:{loading:function(){this.loading?this.$refs.userMembershipDrawer.startLoading():this.$refs.userMembershipDrawer.endLoading()},page:function(){this.refresh()},drawer:function(){this.drawer?this.$refs.userMembershipDrawer.open():this.$refs.userMembershipDrawer.close()}},created:function(){this.$root.$on("openUserMemberships",this.open)},methods:{open:function(e){this.user=e,this.refresh(),this.drawer=!0},refresh:function(){var e=this,t=(this.page-1)*this.pageSize;return this.loading=!0,fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/users/"+this.userName+"/memberships?offset="+t+"&limit="+this.pageSize+"&returnSize=true",{method:"GET",credentials:"include"}).then((function(t){if(t&&t.ok)return t.json();throw new Error(e.$t("IDMManagement.error.UnknownServerError"))})).then((function(t){return e.memberships=t})).finally((function(){return e.loading=!1}))}}},b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("exo-drawer",{ref:"userMembershipDrawer",attrs:{id:"userMembershipDrawer",right:""},on:{closed:function(t){e.drawer=!1}}},[r("template",{slot:"title"},[r("div",{staticClass:"text-truncate",attrs:{title:e.title}},[e._v("\n      "+e._s(e.title)+"\n    ")])]),e._v(" "),r("template",{slot:"content"},[r("v-data-table",{staticClass:"data-table-light-border",attrs:{headers:e.headers,items:e.membershipsArray,loading:e.loading,"loading-text":e.$t("UsersManagement.loadingResults"),"no-results-text":e.$t("UsersManagement.noResultsFound"),"no-data-text":e.$t("UsersManagement.noData"),"hide-default-header":"","hide-default-footer":""},scopedSlots:e._u([{key:"item.membershipType",fn:function(t){var r=t.item;return[e._v("\n        "+e._s(r.membershipType)+"\n      ")]}},{key:"item.groupId",fn:function(t){var s=t.item;return[r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(s.groupLabel))]),e._v(" "),r("v-list-item-subtitle",{staticClass:"caption text-sub-title"},[e._v(e._s(s.groupId))])],1)]}}])})],1),e._v(" "),e.hasPagination?r("template",{slot:"footer"},[r("div",{staticClass:"d-flex justify-center"},[r("v-pagination",{attrs:{length:e.pagesCount,circle:"",light:"",flat:""},on:{input:e.changePage},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1)]):e._e()],2)};b._withStripped=!0;var U=Object(n.a)(w,b,[],!1,null,null,null);U.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementUserMembershipDrawer.vue";var $=U.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-btn",{staticClass:"btn dropdown-button",attrs:{disabled:e.disabled},on:{click:e.openFileSelection}},[r("i",{staticClass:"uiIconImport me-md-3"}),e._v("\n  "+e._s(e.$t("UsersManagement.importCSV"))+"\n  "),e.disabled?e._e():r("v-file-input",{ref:"usersCSVInput",staticClass:"importCSVUsersButton hidden me-4",attrs:{"prepend-icon":"",accept:".csv",clearable:""},on:{change:e.importUsers}})],1)};M._withStripped=!0;var y=Object(n.a)({data:function(){return{disabled:!1}},created:function(){var e=this;this.$root.$on("importCSVStarted",(function(){return e.disabled=!0})),this.$root.$on("importCSVError",(function(){return e.disabled=!1})),this.$root.$on("importCSVFinished",(function(){return e.disabled=!1}))},methods:{openFileSelection:function(){this.$refs.usersCSVInput.$el.getElementsByTagName("input")[0].click()},importUsers:function(e){var t=this;if(e&&e.size){var r=this.$uploadService.generateRandomId();return this.$root.$emit("importCSVStarted",r),this.$uploadService.upload(e,r).then((function(){return t.$userService.importUsers(r)})).then((function(){return t.$root.$emit("importCSVProgress",r)})).catch((function(e){return t.$root.$emit("importCSVError",e)}))}}}},M,[],!1,null,null,null);y.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementImportCSVButton.vue";var C=y.exports,x={props:{error:{type:String,default:null},userName:{type:String,default:null}},computed:{errorMessage:function(){return this.error&&String(this.error).replace("Error: ","")},validationErrorMessage:function(){return this.errorMessage&&this.errorMessage.indexOf("USER_VALIDATION_ERROR:")>-1&&this.errorMessage.split(":")[1]},createUserErrorMessage:function(){return this.errorMessage&&this.errorMessage.indexOf("CREATE_USER_ERROR")>-1&&this.$t("UsersManagement.error.importCSV.errorCreatingUser")},groupNotExistsErrorMessage:function(){return this.errorMessage&&this.errorMessage.indexOf("GROUP_NOT_EXISTS:")>-1&&this.$t("UsersManagement.error.importCSV.groupNotExists",{0:this.errorMessage.split(":")[1]})},membershipNotExistsErrorMessage:function(){return this.errorMessage&&this.errorMessage.indexOf("MEMBERSHIP_TYPE_NOT_EXISTS:")>-1&&this.$t("UsersManagement.error.importCSV.membershipNotExists",{0:this.errorMessage.split(":")[1]})},membershipImportErrorMessage:function(){return this.errorMessage&&this.errorMessage.indexOf("IMPORT_MEMBERSHIP_ERROR:")>-1&&this.$t("UsersManagement.error.importCSV.createMembershipError")},createUserProfileErrorMessage:function(){return this.errorMessage&&this.errorMessage.indexOf("CREATE_USER_PROFILE_ERROR:")>-1&&this.$t("UsersManagement.error.importCSV.createSocialProfileError")}}},S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.error?r("v-flex",{staticClass:"d-flex flex-wrap"},["UPLOAD_ID:MANDATORY"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadIdMandatory"))+"\n  ")]:"UPLOAD_ID:NOT_FOUND"===e.errorMessage||"UPLOAD_ID_FILE:NOT_FOUND"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadedFileNotfound"))+"\n  ")]:"UPLOAD_ID_PROGRESS:NOT_FOUND"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadedFileProgressNotfound"))+"\n  ")]:"UPLOAD_ID_PROCESSING:ALREADY_PROCESSING"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.uploadedFileIsAlreadyProcessing"))+"\n  ")]:"ERROR_READING_FILE"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.errorReadingUploadedFile"))+"\n  ")]:"BAD_FORMAT:FILE_EMPTY"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.fileIsEmpty"))+"\n  ")]:e.createUserErrorMessage?[e._v("\n    "+e._s(e.createUserErrorMessage)+"\n  ")]:"BAD_LINE_FORMAT:MISSING_USERNAME"===e.errorMessage||"BAD_LINE_FORMAT:MISSING_USERNAME"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.missingUserName"))+"\n  ")]:"BAD_LINE_FORMAT"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.badLineFormat"))+"\n  ")]:e.validationErrorMessage?[e._v("\n    "+e._s(e.validationErrorMessage)+"\n  ")]:"USERNAME:ALREADY_EXISTS"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.userAlreadyExists",{0:e.userName}))+"\n  ")]:"EMAIL:ALREADY_EXISTS"===e.errorMessage?[e._v("\n    "+e._s(e.$t("UsersManagement.error.importCSV.emailAlreadyExists",{0:e.userName}))+"\n  ")]:e.groupNotExistsErrorMessage?[e._v("\n    "+e._s(e.groupNotExistsErrorMessage)+"\n  ")]:e.membershipNotExistsErrorMessage?[e._v("\n    "+e._s(e.membershipNotExistsErrorMessage)+"\n  ")]:e.membershipImportErrorMessage?[e._v("\n    "+e._s(e.membershipImportErrorMessage)+"\n  ")]:e.createUserProfileErrorMessage?[e._v("\n    "+e._s(e.createUserProfileErrorMessage)+"\n  ")]:e.membershipImportErrorMessage?[e._v("\n    "+e._s(e.membershipImportErrorMessage)+"\n  ")]:[e._v("\n    "+e._s(e.error)+"\n  ")]],2):e._e()};S._withStripped=!0;var E=Object(n.a)(x,S,[],!1,null,null,null);E.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementImportCSVErrorMessage.vue";var N=E.exports,I={data:function(){return{uploadId:null,progress:null,error:null,errorHeaders:[{value:"userName"},{value:"message"}],itemsPerPageOptions:[20,50,100]}},computed:{warnsCount:function(){return this.warnMessages.length},warnMessages:function(){var e=this;return this.progress&&this.progress.warnMessages?Object.keys(this.progress.warnMessages).flatMap((function(t){return e.progress.warnMessages[t].map((function(e){return{userName:t,message:e}}))})):[]},errorsCount:function(){return this.errorMessages.length},errorMessages:function(){var e=this;return this.progress&&this.progress.errorMessages?Object.keys(this.progress.errorMessages).map((function(t){return{userName:t,message:e.progress.errorMessages[t]}})):[]},uploading:function(){return!this.finished&&!this.progress&&this.uploadId},imported:function(){return this.progress&&this.progress.processedCount>=this.progress.count},finished:function(){return this.error||this.imported},alertType:function(){return this.error?"error":this.finished?"success":"info"},displayAlert:function(){return this.uploading||this.progress||this.finished}},watch:{uploadId:function(){this.progress=null,this.error=null},finished:function(e,t){var r=this;this.finished&&this.uploadId&&this.$userService.cleanImportUsers(this.uploadId).then((function(e){r.progress=e})),e&&e!==t&&this.$root.$emit("importCSVFinished",this.uploadId,this.progress)}},created:function(){var e=this;this.$root.$on("importCSVStarted",(function(t){return e.uploadId=t})),this.$root.$on("importCSVProgress",this.watchProgress),this.$root.$on("importCSVError",(function(t){return e.error=t}))},methods:{watchProgress:function(){var e=this;if(this.uploadId&&!this.finished)return this.$userService.checkImportUsersProgress(this.uploadId).then((function(t){window.setTimeout((function(){return e.progress=t}),200)})).then((function(){return e.$nextTick()})).catch((function(t){String(t).indexOf("SyntaxError")<0&&(e.error=t)})).finally((function(){e.finished||window.setTimeout(e.watchProgress,500)}))}}},D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-flex",[e.displayAlert?r("v-alert",{attrs:{type:e.alertType}},[e.error?r("users-management-import-csv-error-message",{attrs:{error:e.error}}):e.uploading?[e._v("\n      "+e._s(e.$t("UsersManagement.uploadingCSVFile"))+"\n    ")]:e.progress?[r("ul",[r("li",[e.finished?[e._v("\n            "+e._s(e.$t("UsersManagement.finishedImportingCSVFile",{0:e.progress.count}))+"\n          ")]:[e._v("\n            "+e._s(e.$t("UsersManagement.processingCSVFile",{0:e.progress.processedCount,1:e.progress.count}))+"\n          ")]],2),e._v(" "),e.errorsCount?r("li",[e._v("\n          - "+e._s(e.$t("UsersManagement.errorImportingCSVFile"))+": "),r("a",{on:{click:function(t){return e.$refs.errorDrawer.open()}}},[e._v(e._s(e.errorsCount)+" / "+e._s(e.progress.processedCount))])]):e._e(),e._v(" "),e.warnsCount?r("li",[e._v("\n          - "+e._s(e.$t("UsersManagement.warningImportingCSVFile"))+": "),r("a",{on:{click:function(t){return e.$refs.warnDrawer.open()}}},[e._v(e._s(e.warnsCount)+" / "+e._s(e.progress.processedCount))])]):e._e()])]:e._e()],2):e._e(),e._v(" "),r("exo-drawer",{ref:"errorDrawer",attrs:{right:""}},[r("template",{slot:"title"},[e._v(e._s(e.$t("UsersManagement.importCSVErrors")))]),e._v(" "),r("template",{slot:"content"},[r("v-data-table",{attrs:{headers:e.errorHeaders,items:e.errorMessages,"items-per-page":20,"footer-props":{itemsPerPageOptions:e.itemsPerPageOptions},"hide-default-header":""},scopedSlots:e._u([{key:"item.message",fn:function(e){var t=e.item;return[r("users-management-import-csv-error-message",{attrs:{error:t.message,"user-name":t.userName}})]}}])})],1)],2),e._v(" "),r("exo-drawer",{ref:"warnDrawer",attrs:{right:""}},[r("template",{slot:"title"},[e._v(e._s(e.$t("UsersManagement.importCSVWarnings")))]),e._v(" "),r("template",{slot:"content"},[r("v-data-table",{attrs:{headers:e.errorHeaders,items:e.warnMessages,"items-per-page":20,"footer-props":{itemsPerPageOptions:e.itemsPerPageOptions},"hide-default-header":""},scopedSlots:e._u([{key:"item.message",fn:function(e){var t=e.item;return[r("users-management-import-csv-error-message",{attrs:{error:t.message,"user-name":t.userName}})]}}])})],1)],2)],1)};D._withStripped=!0;var F=Object(n.a)(I,D,[],!1,null,null,null);F.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementImportCSVResult.vue";var P=F.exports,T=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("exo-drawer",{ref:"usersFilterDrawer",attrs:{id:"usersFilterDrawer",right:""},on:{closed:function(t){e.drawer=!1}}},[r("template",{slot:"title"},[e._v("\n    "+e._s(e.$t("UsersManagement.filter"))+"\n  ")]),e._v(" "),r("template",{slot:"content"},[r("v-list",[r("v-card",{staticClass:"pa-2",attrs:{flat:""}},[r("v-radio-group",{staticClass:"mt-0",model:{value:e.selectedFiler,callback:function(t){e.selectedFiler=t},expression:"selectedFiler"}},[r("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.lastConnection.connected"),value:"connected"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),r("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.lastConnection.neverConnected"),value:"neverConnected"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),r("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.enrollment.enrolled"),value:"enrolled"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),r("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.enrollment.notEnrolled"),value:"notEnrolled"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),r("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.enrollment.noEnrollmentPossible"),value:"noEnrollmentPossible"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),r("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.type.internal"),value:"internal"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}}),e._v(" "),r("v-radio",{staticClass:"pa-2",attrs:{label:e.$t("UsersManagement.type.external"),value:"external"},on:{click:function(t){return e.resetOption(e.selectedFiler)}}})],1)],1)],1)],1),e._v(" "),r("template",{slot:"footer"},[r("div",{staticClass:"d-flex"},[r("v-btn",{staticClass:"ps-0",attrs:{color:"primary",text:""},on:{click:e.resetFilter}},[r("v-icon",{staticClass:"pe-1"},[e._v("mdi-reload")]),e._v("\n        "+e._s(e.$t("UsersManagement.filter.reset"))+"\n      ")],1),e._v(" "),r("v-spacer"),e._v(" "),r("v-btn",{staticClass:"btn me-2",on:{click:e.cancel}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.cancel"))+"\n      ")]),e._v(" "),r("v-btn",{staticClass:"btn btn-primary",on:{click:e.save}},[e._v("\n        "+e._s(e.$t("UsersManagement.button.save"))+"\n      ")])],1)])],2)};T._withStripped=!0;var A=Object(n.a)({data:function(){return{drawer:!1,selectedFiler:null,previouslySelected:null}},watch:{drawer:function(){this.drawer?this.$refs.usersFilterDrawer.open():this.$refs.usersFilterDrawer.close()}},created:function(){this.$root.$on("advancedFilter",this.advancedFilter)},methods:{advancedFilter:function(e){this.selectedFiler=e,this.drawer=!0},cancel:function(){this.drawer=!1},save:function(){this.$root.$emit("applyAdvancedFilter",this.selectedFiler),this.$refs.usersFilterDrawer.close()},resetFilter:function(){this.selectedFiler=null,this.previouslySelected=null},resetOption:function(e){e===this.previouslySelected&&(this.selectedFiler=null),this.previouslySelected=this.selectedFiler}}},T,[],!1,null,null,null);A.options.__file="src/main/webapp/vue-apps/idm-users-management/components/UsersManagementFilterDrawer.vue";var O={"users-management":a,"users-management-list":d,"users-management-toolbar":f,"users-management-user-form-drawer":_,"users-management-user-membership-drawer":$,"users-management-import-csv-button":C,"users-management-import-csv-result":P,"users-management-import-csv-error-message":N,"users-management-filter-drawer":A.exports};for(var k in O)Vue.component(k,O[k]);if(extensionRegistry){var V=extensionRegistry.loadComponents("UsersManagement");V&&V.length>0&&V.forEach((function(e){Vue.component(e.componentName,e.componentOptions)}))}document.dispatchEvent(new CustomEvent("displayTopBarLoading"));var L="undefined"!=typeof eXo?eXo.env.portal.language:"en",R=eXo.env.portal.context+"/"+eXo.env.portal.rest+"/i18n/bundle/locale.portlet.Portlets-"+L+".json";function z(){exoi18n.loadLanguageAsync(L,R).then((function(e){Vue.createApp({mounted:function(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:'<users-management id="UsersManagement" />',vuetify:Vue.prototype.vuetifyOptions,i18n:e},"#UsersManagement","Users Management")}))}}})}));