define((function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}({0:function(t,e,n){"use strict";function i(t,e,n,i,s,a,o,l){var r=typeof(t=t||{}).default;"object"!==r&&"function"!==r||(t=t.default);var c,u="function"==typeof t?t.options:t;if(e&&(u.render=e,u.staticRenderFns=n,u._compiled=!0),i&&(u.functional=!0),a&&(u._scopeId=a),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=c):s&&(c=l?function(){s.call(this,this.$root.$options.shadowRoot)}:s),c)if(u.functional){u._injectStyles=c;var p=u.render;u.render=function(t,e){return c.call(e),p(t,e)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:u}}n.d(e,"a",(function(){return i}))},18:function(t,e,n){"use strict";n.r(e),n.d(e,"init",(function(){return k}));var i={data:function(){return{id:"Notifications"+parseInt(1e4*Math.random()).toString().toString(),notificationSettings:null,displayDetails:!1,displayed:!0}},created:function(){var t=this;document.addEventListener("hideSettingsApps",(function(e){e&&e.detail&&t.id!==e.detail&&(t.displayed=!1)})),document.addEventListener("showSettingsApps",(function(){return t.displayed=!0})),this.$root.$on("refresh",this.refresh),this.refresh()},methods:{refresh:function(){var t=this;return fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/notifications/settings/"+eXo.env.portal.userName).then((function(t){return t&&t.ok&&t.json()})).then((function(e){return t.notificationSettings=e,t.$nextTick()})).finally((function(){t.$nextTick().then((function(){return t.$root.$applicationLoaded()}))}))},openDetail:function(){document.dispatchEvent(new CustomEvent("hideSettingsApps",{detail:this.id})),this.displayDetails=!0},closeDetail:function(){document.dispatchEvent(new CustomEvent("showSettingsApps")),this.displayDetails=!1}}},s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.displayed?n("v-app",[t.displayDetails?n("user-setting-notifications-window",{attrs:{settings:t.notificationSettings},on:{back:t.closeDetail}}):n("v-card",{staticClass:"ma-4 border-radius",attrs:{flat:""}},[n("v-list",{on:{click:t.openNotificationSettingDetail}},[n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",{staticClass:"title text-color"},[t._v("\n            "+t._s(t.$t("UserSettings.notifications"))+"\n          ")])],1)],1),t._v(" "),t.notificationSettings&&t.notificationSettings.channels?t._l(t.notificationSettings.channels,(function(e){return n("user-setting-notification-channel",{key:e,attrs:{channel:e,active:t.notificationSettings.channelStatus[e],settings:t.notificationSettings}})})):t._e(),t._v(" "),n("v-list-item",[n("v-list-item-content",[n("v-list-item-title",{staticClass:"title text-color"},[t._v("\n            "+t._s(t.$t("UserSettings.manageNotifications"))+"\n          ")])],1),t._v(" "),n("v-list-item-action",[n("v-btn",{attrs:{small:"",icon:""},on:{click:t.openDetail}},[n("v-icon",{staticClass:"text-sub-title",attrs:{size:"24"}},[t._v("\n              "+t._s(t.$vuetify.rtl?"fa-caret-left":"fa-caret-right")+"\n            ")])],1)],1)],1)],2)],1)],1):t._e()};s._withStripped=!0;var a=n(0),o=Object(a.a)(i,s,[],!1,null,null,null);o.options.__file="src/main/webapp/vue-apps/user-setting-notifications/components/UserSettingNotifications.vue";var l=o.exports,r={props:{settings:{type:Object,default:null}},data:function(){return{selectedPlugin:null,selectedGroup:null}},methods:{openDrawer:function(t,e){this.selectedPlugin=t,this.selectedGroup=e,this.$nextTick(this.$refs.drawer.open)}}},c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.settings?n("v-card",{staticClass:"ma-4",attrs:{flat:""}},[n("v-toolbar",{staticClass:"border-box-sizing",attrs:{flat:""}},[n("v-btn",{staticClass:"mx-1",attrs:{icon:"",height:"36",width:"36"},on:{click:function(e){return t.$emit("back")}}},[n("v-icon",{attrs:{size:"20"}},[t._v("\n        "+t._s(t.$vuetify.rtl?"mdi-arrow-right":"mdi-arrow-left")+"\n      ")])],1),t._v(" "),n("v-toolbar-title",{staticClass:"ps-0"},[t._v("\n      "+t._s(t.$t("UserSettings.manageNotifications"))+"\n    ")]),t._v(" "),n("v-spacer")],1),t._v(" "),n("v-flex",{staticClass:"ma-3 white"},t._l(t.settings.groups,(function(e){return n("user-setting-notification-group",{key:e.groupId,attrs:{settings:t.settings,group:e},on:{edit:t.openDrawer}})})),1),t._v(" "),n("user-setting-notification-drawer",{ref:"drawer",attrs:{group:t.selectedGroup,plugin:t.selectedPlugin,settings:t.settings}})],1):t._e()};c._withStripped=!0;var u=Object(a.a)(r,c,[],!1,null,null,null);u.options.__file="src/main/webapp/vue-apps/user-setting-notifications/components/UserSettingNotificationsWindow.vue";var p=u.exports,d={props:{channel:{type:String,default:null},active:{type:Boolean,default:null},settings:{type:Object,default:null}},data:function(){return{saving:!1}},computed:{label:function(){return this.settings&&this.settings.channelLabels&&this.settings.channelLabels[this.channel]},description:function(){return this.settings&&this.settings.channelDescriptions&&this.settings.channelDescriptions[this.channel]}},methods:{save:function(){var t=this;return fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/notifications/settings/"+eXo.env.portal.userName+"/channel/"+this.channel,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"enable="+this.active}).then((function(e){e&&e.ok&&t.$root.$emit("refresh")})).finally((function(){t.saving=!1}))}}},f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-list-item",{attrs:{"two-line":""}},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"text-color"},[t._v("\n        "+t._s(t.label)+"\n      ")]),t._v(" "),t.description?n("v-list-item-subtitle",{staticClass:"text-sub-title font-italic"},[t._v("\n        "+t._s(t.description)+"\n      ")]):t._e()],1),t._v(" "),n("v-list-item-action",[n("v-switch",{attrs:{loading:t.saving},on:{change:t.save},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}})],1)],1),t._v(" "),n("v-divider",{staticClass:"mx-4"})],1)};f._withStripped=!0;var h=Object(a.a)(d,f,[],!1,null,null,null);h.options.__file="src/main/webapp/vue-apps/user-setting-notifications/components/UserSettingNotificationChannel.vue";var g=h.exports,v={props:{group:{type:Object,default:null},settings:{type:Object,default:null}},computed:{label:function(){return this.settings&&this.settings.groupsLabels&&this.settings.groupsLabels[this.group.groupId]},manageNotification:function(){return this.group&&this.group.pluginInfos&&this.group.pluginInfos.length&&"quarantine"!==this.group.groupId&&"malwareDetection"!==this.group.groupId}},methods:{openNotificationSettingDetail:function(){}}},m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.manageNotification?n("div",{staticClass:"border-radius border-color ma-4"},[n("v-list-item",{attrs:{dense:""}},[n("v-list-item-content",[n("v-list-item-title",{staticClass:"text-color font-weight-bold subtitle-1"},[t._v("\n        "+t._s(t.label)+"\n      ")])],1)],1),t._v(" "),t._l(t.group.pluginInfos,(function(e){return n("user-setting-notification-plugin",{key:e.type,attrs:{plugin:e,settings:t.settings},on:{edit:function(n){return t.$emit("edit",e,t.group)}}})}))],2):t._e()};m._withStripped=!0;var b=Object(a.a)(v,m,[],!1,null,null,null);b.options.__file="src/main/webapp/vue-apps/user-setting-notifications/components/UserSettingNotificationGroup.vue";var _=b.exports,C={props:{plugin:{type:Object,default:null},settings:{type:Object,default:null}},computed:{label:function(){return this.settings&&this.settings.pluginLabels&&this.settings.pluginLabels[this.plugin.type]},hasInstantNotificationSettings:function(){return this.enabledNotificationLabels&&this.enabledNotificationLabels.length||this.enabledDigest},hasNotificationSettings:function(){return this.hasInstantNotificationSettings||this.enabledDigest},enabledDigest:function(){var t=this;return this.settings&&this.settings.emailDigestChoices&&this.settings.emailDigestChoices.find((function(e){return e&&e.channelActive&&e.channelId===t.settings.emailChannel&&e.pluginId===t.plugin.type}))},enabledDigestLabel:function(){return this.enabledDigest&&this.settings.digestDescriptions&&this.enabledDigest.value&&"Never"!==this.enabledDigest.value&&this.settings.digestDescriptions[this.enabledDigest.value]},enabledNotifications:function(){var t=this;return this.settings&&this.settings.channelCheckBoxList&&this.settings.channelCheckBoxList.filter((function(e){return e.active&&e.channelActive&&e.pluginId===t.plugin.type}))},enabledNotificationLabels:function(){var t=this;return this.enabledNotifications&&this.enabledNotifications.map((function(e){return t.settings.channelLabels[e.channelId]}))}}},y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("v-divider"),t._v(" "),n("v-list-item",{attrs:{dense:""}},[n("v-list-item-content",{staticClass:"px-0 pb-0 pt-2 mt-auto mb-2"},[n("v-list-item-title",{staticClass:"text-color text-wrap"},[t._v("\n        "+t._s(t.label)+"\n      ")])],1),t._v(" "),n("v-list-item-action",{staticClass:"ma-auto"},[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("edit")}}},[n("i",{staticClass:"uiIconEdit uiIconLightBlue pb-2"})])],1)],1),t._v(" "),t.hasNotificationSettings?n("v-list-item",{attrs:{dense:""}},[n("v-list-item-content",{staticClass:"pa-0"},[n("v-list-item-title",{staticClass:"text-wrap"},[t.enabledDigestLabel?[n("v-chip",{staticClass:"ma-2",attrs:{color:"primary"}},[t._v("\n            "+t._s(t.enabledDigestLabel)+"\n          ")])]:t._e(),t._v(" "),t.enabledNotificationLabels&&t.enabledNotificationLabels.length?t._l(t.enabledNotificationLabels,(function(e){return n("v-chip",{key:e,staticClass:"ma-2",attrs:{color:"primary"}},[t._v("\n            "+t._s(e)+"\n          ")])})):t._e()],2)],1)],1):n("v-list-item",{attrs:{dense:""}},[n("v-list-item-content",{staticClass:"pa-0"},[n("v-list-item-subtitle",{staticClass:"text-sub-title font-italic"},[t._v("\n        "+t._s(t.$t("UINotification.label.NoNotifications"))+"\n      ")])],1)],1)],1)};y._withStripped=!0;var w=Object(a.a)(C,y,[],!1,null,null,null);w.options.__file="src/main/webapp/vue-apps/user-setting-notifications/components/UserSettingNotificationPlugin.vue";var x=w.exports,S={props:{plugin:{type:Object,default:null},group:{type:Object,default:null},settings:{type:Object,default:null}},data:function(){return{channels:{},digest:null,emailChannel:null,listChannelOptions:[]}},computed:{digestOptions:function(){var t=this;return this.settings&&Object.keys(this.settings.digestLabels).map((function(e){return{value:e,text:t.settings.digestLabels[e]}}))},channelLabels:function(){return this.settings&&this.settings.channelLabels},groupLabel:function(){return this.settings&&this.group&&this.settings.groupsLabels[this.group.groupId]}},methods:{open:function(){var t=this;this.emailChannel=this.settings&&this.settings.emailChannel;var e=this.group&&this.group.pluginInfos[0]&&this.group.pluginInfos[0].allChannelActive||[],n=this.settings&&this.settings.emailDigestChoices&&this.settings.emailDigestChoices.find((function(e){return e&&e.channelActive&&e.channelId===t.emailChannel&&e.pluginId===t.plugin.type}));this.digest=n&&n.value,this.listChannelOptions=this.settings&&this.settings.channelCheckBoxList&&this.settings.channelCheckBoxList.filter((function(e){return e.active&&e.channelActive&&e.pluginId===t.plugin.type}))||[],this.channels={},this.settings.channels.forEach((function(n){t.listChannelOptions.find((function(t){return t.channelId===n}))||t.listChannelOptions.push({channelId:n,active:!1,channelActive:t.settings.channelStatus[n]&&e.includes(n)}),t.channels[n]=!1})),this.listChannelOptions.forEach((function(e){t.channels[e.channelId]=e.active&&e.channelActive})),this.listChannelOptions.sort((function(t,e){return t.channelId.localeCompare(e.channelId)})),this.$refs.drawer.open()},save:function(){var t=this;this.$refs.drawer.startLoading();var e=Object.keys(this.channels).map((function(e){return e+"="+t.channels[e]})).join(",");return fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/notifications/settings/"+eXo.env.portal.userName+"/plugin/"+this.plugin.type,{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"digest="+this.digest+"&channels="+e}).then((function(e){e&&e.ok&&(t.$root.$emit("refresh"),t.$refs.drawer.close())})).finally((function(){t.$refs.drawer.endLoading()}))},cancel:function(){this.$refs.drawer.close()}}},N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("exo-drawer",{ref:"drawer",staticClass:"userNotificationDrawer",attrs:{"body-classes":"hide-scroll decrease-z-index-more",right:""}},[n("template",{slot:"title"},[t._v("\n    "+t._s(t.groupLabel)+"\n  ")]),t._v(" "),n("template",{slot:"content"},t._l(t.listChannelOptions,(function(e){return n("div",{key:e.channelId},[n("v-row",{staticClass:"ma-0 d-flex"},[n("v-col",{staticClass:"flex-grow-1"},[n("label",{staticClass:"my-auto",attrs:{for:e.channelId}},[t._v(t._s(t.channelLabels[e.channelId]))])]),t._v(" "),n("v-col",{staticClass:"text-right flex-grow-0"},[n("v-switch",{staticClass:"mt-0",attrs:{name:e.channelId,disabled:!e.channelActive,"hide-details":"",dense:""},model:{value:t.channels[e.channelId],callback:function(n){t.$set(t.channels,e.channelId,n)},expression:"channels[pluginOption.channelId]"}})],1)],1),t._v(" "),e.channelId===t.emailChannel?[n("v-row",{staticClass:"ma-0"},[n("v-col",[n("label",{staticClass:"align-start",attrs:{for:"EMAIL_DIGEST"}},[t._v(t._s(t.$t("UINotification.label.selectBox-mail")))])]),t._v(" "),n("v-col",{staticClass:"text-right"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.digest,expression:"digest"}],staticClass:"col-auto me-2 my-auto px-3 py-0 subtitle-1 ignore-vuetify-classes",attrs:{disabled:!e.channelActive,name:"EMAIL_DIGEST"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.digest=e.target.multiple?n:n[0]}}},t._l(t.digestOptions,(function(e){return n("option",{key:e.value,domProps:{value:e.value}},[t._v("\n                "+t._s(e.text)+"\n              ")])})),0)])],1)]:t._e()],2)})),0),t._v(" "),n("template",{slot:"footer"},[n("div",{staticClass:"d-flex"},[n("v-spacer"),t._v(" "),n("v-btn",{staticClass:"btn me-2",on:{click:t.cancel}},[t._v("\n        "+t._s(t.$t("UserSettings.button.cancel"))+"\n      ")]),t._v(" "),n("v-btn",{staticClass:"btn btn-primary",on:{click:t.save}},[t._v("\n        "+t._s(t.$t("UserSettings.button.apply"))+"\n      ")])],1)])],2)};N._withStripped=!0;var I=Object(a.a)(S,N,[],!1,null,null,null);I.options.__file="src/main/webapp/vue-apps/user-setting-notifications/components/UserSettingNotificationDrawer.vue";var $={"user-setting-notifications":l,"user-setting-notifications-window":p,"user-setting-notification-channel":g,"user-setting-notification-group":_,"user-setting-notification-plugin":x,"user-setting-notification-drawer":I.exports};for(var L in $)Vue.component(L,$[L]);if(extensionRegistry){var O=extensionRegistry.loadComponents("UserSettingNotifications");O&&O.length>0&&O.forEach((function(t){Vue.component(t.componentName,t.componentOptions)}))}document.dispatchEvent(new CustomEvent("displayTopBarLoading"));var D=eXo&&eXo.env.portal.language||"en",j=[eXo.env.portal.context+"/"+eXo.env.portal.rest+"/i18n/bundle/locale.portlet.notification.UserNotificationPortlet-"+D+".json",eXo.env.portal.context+"/"+eXo.env.portal.rest+"/i18n/bundle/locale.portlet.social.UserSettings-"+D+".json"],E="UserSettingNotifications";function k(t){exoi18n.loadLanguageAsync(D,j).then((function(e){var n=document.createElement("div");n.id=E,Vue.createApp({data:{settings:t},mounted:function(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:'<user-setting-notifications v-cacheable id="'+E+'" :languages="settings && settings.languages" :timezones="settings && settings.timezones" />',i18n:e,vuetify:Vue.prototype.vuetifyOptions},n,"User Settings Notifications")}))}}})}));