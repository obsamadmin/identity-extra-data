define((function(){return function(t){var e={};function s(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,s),n.l=!0,n.exports}return s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=27)}({0:function(t,e,s){"use strict";function a(t,e,s,a,n,i,r,o){var c=typeof(t=t||{}).default;"object"!==c&&"function"!==c||(t=t.default);var p,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=s,l._compiled=!0),a&&(l.functional=!0),i&&(l._scopeId=i),r?(p=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=p):n&&(p=o?function(){n.call(this,this.$root.$options.shadowRoot)}:n),p)if(l.functional){l._injectStyles=p;var u=l.render;l.render=function(t,e){return p.call(e),u(t,e)}}else{var v=l.beforeCreate;l.beforeCreate=v?[].concat(v,p):[p]}return{exports:t,options:l}}s.d(e,"a",(function(){return a}))},27:function(t,e,s){"use strict";function a(){return fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/social/spacesMemberships?status=invited&limit=-1",{method:"GET",credentials:"include"}).then((function(t){if(t&&t.ok)return t.json();throw new Error("Error when getting external spaces requests")}))}s.r(e),s.d(e,"init",(function(){return g}));var n={data:function(){return{spacesList:[],spacesRequestsSize:0}},computed:{isShown:function(){return this.spacesList&&this.spacesList.length>0||this.spacesRequestsSize>0}},created:function(){var t=this;this.getExternalSpacesList(),a().then((function(e){t.spacesRequestsSize=e.spacesMemberships.length})).finally((function(){return t.$root.$applicationLoaded()}))},methods:{getExternalSpacesList:function(){var t=this;fetch(""+Vue.prototype.$spacesConstants.SOCIAL_USER_API+eXo.env.portal.userName+"/spaces?limit=-1",{method:"GET",credentials:"include"}).then((function(t){if(t&&t.ok)return t.json();throw new Error("Error when getting spaces of current user")})).then((function(e){t.spacesList=e.spaces}))},refreshSpaces:function(t){this.spacesList.unshift(t)}}},i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isShown?s("v-app",[s("v-flex",{attrs:{"d-flex":"",xs12:"",sm12:""}},[s("v-layout",{attrs:{row:"",wrap:"","mx-0":""}},[s("v-flex",{attrs:{"d-flex":"",xs12:""}},[s("v-card",{staticClass:"flex",attrs:{flat:""}},[s("v-card-title",{staticClass:"external-spaces-list-title subtitle-1 text-uppercase pb-2"},[s("span",{staticClass:"title"},[t._v("\n                "+t._s(t.$t("externalSpacesList.title.yourSpaces"))+"\n              ")])]),t._v(" "),s("v-list",{attrs:{dense:""}},[[t._l(t.spacesList,(function(t){return s("external-space-item",{key:t.id,attrs:{space:t}})})),t._v(" "),s("external-spaces-requests-items",{on:{invitationReplied:t.refreshSpaces}})]],2)],1)],1)],1)],1)],1):t._e()],1)};i._withStripped=!0;var r=s(0),o=Object(r.a)(n,i,[],!1,null,null,null);o.options.__file="src/main/webapp/vue-apps/external-spaces-list/components/ExternalSpacesList.vue";var c=o.exports,p={props:{space:{type:Object,default:function(){return null}},avatarSize:{type:Number,default:function(){return 37}}},computed:{avatarUrl:function(){return this.space.avatarUrl||eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/social/spaces/"+this.space.prettyName+"/avatar"},url:function(){if(!this.space||!this.space.groupId)return"#";var t=this.space.groupId.replace(/\//g,":");return eXo.env.portal.context+"/g/"+t+"/"}}},l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-list-item",{staticClass:"pa-1 pb-1",attrs:{href:t.url}},[s("v-list-item-avatar",{staticClass:"my-0 ps-4",attrs:{href:t.url,tile:""}},[s("v-avatar",{attrs:{size:t.avatarSize,tile:""}},[s("v-img",{staticClass:"mx-auto spaceAvatar",attrs:{src:t.avatarUrl,height:t.avatarSize,width:t.avatarSize,"max-height":t.avatarSize,"max-width":t.avatarSize}})],1)],1),t._v(" "),s("v-list-item-content",{staticClass:"pa-0",attrs:{id:t.id}},[s("v-list-item-title",[s("a",{staticClass:"text-color text-truncate spaceTitle"},[t._v("\n        "+t._s(t.space.displayName)+"\n      ")])])],1)],1)};l._withStripped=!0;var u=Object(r.a)(p,l,[],!1,null,null,null);u.options.__file="src/main/webapp/vue-apps/external-spaces-list/components/ExternalSpaceItem.vue";var v=u.exports,d={props:{avatarSize:{type:Number,default:function(){return 37}}},data:function(){return{spacesRequests:[]}},created:function(){this.getSpacesRequests()},methods:{getSpacesRequests:function(){var t=this;this.spacesRequests=[],a().then((function(e){for(var s=function(s){var a={};a.id=e.spacesMemberships[s].id,fetch(""+e.spacesMemberships[s].space,{method:"GET",credentials:"include"}).then((function(t){if(t&&t.ok)return t.json();throw new Error("Error when getting space")})).then((function(e){a.avatar=e.avatarUrl||"/portal/rest/v1/social/spaces/"+a.id.split(":")[0]+"/avatar",a.displayName=e.displayName,t.spacesRequests.splice(s,0,a)}))},a=0;a<e.spacesMemberships.length;a++)s(a)}))},replyInvitationToJoinSpace:function(t,e){var s=this;(function(t,e){var s={status:""+e};return fetch(eXo.env.portal.context+"/"+eXo.env.portal.rest+"/v1/social/spacesMemberships/"+t,{method:"PUT",credentials:"include",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then((function(t){if(t&&t.ok)return t.json();throw new Error("Error when replying invitation to join space")}))})(t,e).then((function(){if("approved"===e){var a=s.spacesRequests.filter((function(e){return e.id===t}))[0],n={id:a.id,displayName:a.displayName,avatarUrl:a.avatar};s.$emit("invitationReplied",n)}s.getSpacesRequests()}))}}},f=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("v-layout",{attrs:{row:"",wrap:"","pa-1":"","pb-1":"","mx-0":""}},[s("v-flex",{attrs:{xs12:""}},[s("v-list",[t._l(t.spacesRequests,(function(e){return[s("v-list-item",{key:e.id,staticClass:"py-0 px-2"},[s("v-list-item-avatar",{staticClass:"my-0 ps-2",attrs:{tile:""}},[s("v-avatar",{attrs:{size:t.avatarSize,tile:""}},[s("v-img",{staticClass:"mx-auto spaceAvatar",attrs:{src:e.avatar,height:t.avatarSize,width:t.avatarSize,"max-height":t.avatarSize,"max-width":t.avatarSize}})],1)],1),t._v(" "),s("v-list-item-content",{staticClass:"py-0"},[s("v-list-item-title",{staticClass:"text-color text-truncate requestSpaceName",domProps:{textContent:t._s(e.displayName)}}),t._v(" "),s("v-list-item-subtitle",{staticClass:"caption grey-color",domProps:{textContent:t._s(e.description)}})],1),t._v(" "),s("v-list-item-action",[s("v-btn-toggle",{staticClass:"transparent",attrs:{dark:""}},[s("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:t.$t("externalSpacesList.tooltip.AcceptToJoin"),expression:"$t('externalSpacesList.tooltip.AcceptToJoin')",modifiers:{bottom:!0,body:!0}}],staticClass:"px-0",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(s){return t.replyInvitationToJoinSpace(e.id,"approved")}}},[s("v-icon",{attrs:{color:"green",size:"20"}},[t._v("mdi-checkbox-marked-circle")])],1),t._v(" "),s("v-btn",{directives:[{name:"exo-tooltip",rawName:"v-exo-tooltip.bottom.body",value:t.$t("externalSpacesList.tooltip.DeclineInvitation"),expression:"$t('externalSpacesList.tooltip.DeclineInvitation')",modifiers:{bottom:!0,body:!0}}],staticClass:"px-0",attrs:{text:"",icon:"",small:"","min-width":"auto"},on:{click:function(s){return t.replyInvitationToJoinSpace(e.id,"ignored")}}},[s("v-icon",{attrs:{color:"red",size:"20"}},[t._v("mdi-close-circle")])],1)],1)],1)],1)]}))],2)],1)],1)};f._withStripped=!0;var m=Object(r.a)(d,f,[],!1,null,null,null);m.options.__file="src/main/webapp/vue-apps/external-spaces-list/components/ExternalSpacesRequestsItems.vue";var h={"external-spaces-list":c,"external-space-item":v,"external-spaces-requests-items":m.exports};for(var x in h)Vue.component(x,h[x]);var _="undefined"!=typeof eXo?eXo.env.portal.language:"en",y=Vue.prototype.$spacesConstants.PORTAL+"/"+Vue.prototype.$spacesConstants.PORTAL_REST+"/i18n/bundle/locale.portlet.social.ExternalSpacesListApplication-"+_+".json";if(extensionRegistry){var S=extensionRegistry.loadComponents("ExternalSpacesList");S&&S.length>0&&S.forEach((function(t){Vue.component(t.componentName,t.componentOptions)}))}document.dispatchEvent(new CustomEvent("displayTopBarLoading"));var b="ExternalSpacesListPortlet";function g(){exoi18n.loadLanguageAsync(_,y).then((function(t){Vue.createApp({mounted:function(){document.dispatchEvent(new CustomEvent("hideTopBarLoading"))},template:'<external-spaces-list id="'+b+'" />',i18n:t,vuetify:Vue.prototype.vuetifyOptions},"#"+b,"External Spaces List")}))}}})}));